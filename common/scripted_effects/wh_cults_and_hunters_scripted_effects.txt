###Hunter employment effects, all from employer scope###
create_random_hunter_effect = {
    create_random_intriguer = {
        min_age = 25
        max_age = 50
        female = 25
        health = 6.0
        random_traits = no
        add_trait = witch_hunter
    }
    new_character = {
        save_event_target_as = hunter_candidate
        if = {
            limit = {
                ROOT = {
                    trait = creature_human
                }
            }
            add_trait = creature_human
        }
        #scarring
        witch_hunter_scarring_effect = yes
        random = {
            chance = 60
            add_trait = cruel
        }
        random = {
            chance = 50
            add_trait = paranoid
        }
    }
}

witch_hunter_scarring_effect = {
    random_list = {
        25 = {
            modifier = {
                factor = 2
                age < 30
            }
            #none
        }
        25 = {
            add_trait = scarred
        }
        25 = {
            add_trait = scarred_mid
        }
        25 = {
            modifier = {
                factor = 2
                age > 40
            }
            add_trait = scarred_high
        }
    }
}

create_adventurer_hunter_effect = {
    create_random_hunter_effect = yes
    event_target:hunter_candidate = {
        change_intrigue = 1
        add_trait = brave
        random = {
            chance = 60
            change_intrigue = 1
        }
        random = {
            chance = 70
            add_trait = ambitious
        }
        random = {
            chance = 30
            add_trait = shrewd
        }
        random_list = {
            25 = {
                set_character_flag = army_veteran_witch_hunter
                change_martial = 2
                random_list = {
                    40 = {
                        add_trait = duelist
                    }
                    20 = {
                        add_trait = strategist
                    }
                }
                random = {
                    chance = 70
                    add_trait = robust
                }
                random = {
                    chance = 40
                    add_trait = proud
                }
                random = {
                    chance = 40
                    add_trait = uncouth
                }
            }
            25 = {
                set_character_flag = bold_scholar_witch_hunter
                change_learning = 2
                random_list = {
                    20 = {
                        add_trait = scholar
                    }
                    20 = {
                        add_trait = mystic
                    }
                    20 = {
                        add_trait = theologian
                    }
                }
                random = {
                    chance = 70
                    add_trait = diligent
                }
                random = {
                    chance = 40
                    add_trait = erudite
                }
                random = {
                    chance = 40
                    add_trait = shy
                }
            }
            25 = {
                set_character_flag = crafty_spy_witch_hunter
                change_intrigue = 1 #this is a more important stat for hunters
                random_list = {
                    20 = {
                        add_trait = schemer
                    }
                    20 = {
                        add_trait = socializer
                    }
                    20 = {
                        add_trait = gamer
                    }
                }
                random = {
                    chance = 70
                    add_trait = deceitful
                }
                random = {
                    chance = 40
                    add_trait = cynical
                }
                #in addition to regular chance to be paranoid
                random = {
                    chance = 40
                    add_trait = paranoid
                }
            }
        }
    }
}

create_myrmidian_inquisitor_witch_hunter_effect = {
    random_list = {
        40 = {
            create_random_intriguer = {
                min_age = 25
                max_age = 50
                religion = classical_pantheon
                culture = reman
                female = 25
                health = 6.0
                random_traits = no
                add_trait = witch_hunter
                add_trait = creature_human
            }
        }
        20 = {
            create_random_intriguer = {
                min_age = 25
                max_age = 50
                religion = classical_pantheon
                culture = astur
                female = 25
                health = 6.0
                random_traits = no
                add_trait = witch_hunter
                add_trait = creature_human
            }
        }
    }
    new_character = {
        save_event_target_as = hunter_candidate
        set_character_flag = myrmidian_inquisitor_witch_hunter
        witch_hunter_scarring_effect = yes
        change_martial = 1
        change_intrigue = 2
        change_learning = 1
        add_trait = zealous
        add_trait = creature_human
        add_trait = patron_myrmidia
        set_character_flag = has_patron
        random = {
            chance = 70
            change_intrigue = 1
        }
        random = {
            chance = 70
            add_trait = diligent
        }
        random = {
            chance = 70
            add_trait = proud
        }
        random = {
            chance = 50
            add_trait = shrewd
        }
        random = {
            chance = 40
            add_trait = just
        }
        random = {
            chance = 40
            add_trait = stubborn
        }
        random_list = {
            20 = {
                add_trait = theologian
            }
            20 = {
                add_trait = strategist
            }
            20 = {
                add_trait = impaler
            }
        }
    }
}

create_bretonnian_knight_witch_hunter_effect = {
    create_random_intriguer = {
        min_age = 25
        max_age = 50
        culture = armoric
        religion = grail
        female = no
        health = 6.0
        random_traits = no
        add_trait = witch_hunter
        add_trait = creature_human
    }
    new_character = {
        save_event_target_as = hunter_candidate
        set_character_flag = bretonnian_knight_witch_hunter
        witch_hunter_scarring_effect = yes
        change_martial = 4
        change_intrigue = 2
        add_trait = zealous
        add_trait = brave
        add_trait = bretonnian_knight
        add_trait = creature_human
        join_society = knights_of_bretonnia
        random_list = {
            10 = {
                culture = armoric
            }
            10 = {
                culture = bourgon
            }
            10 = {
                culture = bourgon
            }
            10 = {
                culture = carcassian
            }
            10 = {
                culture = gascon
            }
            10 = {
                culture = gisoren
            }
            10 = {
                culture = mousillonian
            }
            10 = {
                culture = nortagnese
            }
        }
        random = {
            chance = 70
            change_intrigue = 1
        }
        random = {
            chance = 70
            add_trait = diligent
        }
        random = {
            chance = 70
            add_trait = proud
        }
        random = {
            chance = 50
            add_trait = temperate
        }
        random = {
            chance = 40
            add_trait = chaste
        }
        random = {
            chance = 40
            add_trait = shrewd
        }
        random_list = {
            20 = {
                add_trait = duelist
            }
            20 = {
                add_trait = strategist
            }
        }
    }
}

create_sigmarite_templar_witch_hunter_effect = {
    create_random_intriguer = {
        min_age = 25
        max_age = 50
        culture = witchhunter_culture
        religion = imperial_pantheon
        female = 25
        health = 6.0
        random_traits = no
        add_trait = witch_hunter
        add_trait = zealous
        add_trait = brave
        add_trait = creature_human
        add_trait = patron_sigmar
    }
    new_character = {
        save_event_target_as = hunter_candidate
        set_character_flag = sigmarite_templar_witch_hunter
        set_character_flag = has_patron
        change_martial = 1
        change_intrigue = 3
        witch_hunter_scarring_effect = yes
        random = {
            chance = 60
            add_trait = cruel
        }
        random = {
            chance = 50
            add_trait = paranoid
        }
        random = {
            chance = 70
            change_intrigue = 1
        }
        random = {
            chance = 70
            add_trait = stubborn
        }
        random = {
            chance = 70
            add_trait = diligent
        }
        random = {
            chance = 50
            add_trait = shrewd
        }
        random = {
            chance = 40
            add_trait = paranoid
        }
        random = {
            chance = 40
            add_trait = cruel
        }
        random_list = {
            20 = {
                add_trait = duelist
            }
            20 = {
                add_trait = theologian
            }
            20 = {
                add_trait = schemer
            }
        }
    }
}

create_ice_witch_witch_hunter_effect = {
    create_random_intriguer = {
        min_age = 25
        max_age = 50
        religion = kislev_gods
        culture = gospodar
        female = yes
        health = 6.0
        random_traits = no
        add_trait = witch_hunter
        add_trait = lore_ice
        add_trait = ice_witch
        add_trait = creature_human
    }
    new_character = {
        save_event_target_as = hunter_candidate
        set_character_flag = ice_witch_witch_hunter
        witch_hunter_scarring_effect = yes
        change_diplomacy = 1
        change_intrigue = 2
        change_learning = 1
        join_society = ice_witch_sisterhood
        random_list = {
            30 = {
                add_trait = magic_potential_2
            }
            15 = {
                add_trait = magic_potential_3
            }
            5 = {
                add_trait = magic_potential_4
            }
        }
        random = {
            chance = 70
            change_intrigue = 1
        }
        random = {
            chance = 70
            add_trait = patient
        }
        random = {
            chance = 70
            add_trait = proud
        }
        random = {
            chance = 50
            add_trait = shrewd
        }
        random = {
            chance = 40
            add_trait = chaste
        }
        random = {
            chance = 40
            add_trait = ambitious
        }
        random_list = {
            20 = {
                add_trait = mystic
            }
            20 = {
                add_trait = hunter
            }
        }
    }
}

create_order_of_the_shroud_witch_hunter_effect = {
    create_random_hunter_effect = yes
    event_target:hunter_candidate = {
        set_character_flag = order_of_the_shroud_witch_hunter
        change_martial = 1
        change_intrigue = 3
        add_trait = zealous
        add_trait = brave
        add_trait = patron_morr
        set_character_flag = has_patron
        random = {
            chance = 70
            change_intrigue = 1
        }
        random = {
            chance = 70
            add_trait = stubborn
        }
        random = {
            chance = 70
            add_trait = patient
        }
        random = {
            chance = 50
            add_trait = shrewd
        }
        random = {
            chance = 40
            add_trait = robust
        }
        random = {
            chance = 40
            add_trait = erudite
        }
        random_list = {
            20 = {
                add_trait = duelist
            }
            20 = {
                add_trait = theologian
            }
            20 = {
                add_trait = mystic
            }
        }
    }
}

create_order_of_the_sword_and_scale_witch_hunter_effect = {
    create_random_hunter_effect = yes
    event_target:hunter_candidate = {
        set_character_flag = order_of_the_sword_and_scale_witch_hunter
        change_stewardship = 1
        change_intrigue = 3
        change_learning = 1
        add_trait = brave
        add_trait = patron_verena
        set_character_flag = has_patron
        random = {
            chance = 70
            change_intrigue = 1
        }
        random = {
            chance = 70
            add_trait = erudite
        }
        random = {
            chance = 70
            add_trait = just
        }
        random = {
            chance = 50
            add_trait = shrewd
        }
        random = {
            chance = 40
            add_trait = diligent
        }
        random = {
            chance = 40
            add_trait = erudite
        }
        random_list = {
            20 = {
                add_trait = scholar
            }
            20 = {
                add_trait = theologian
            }
            20 = {
                add_trait = mystic
            }
        }
    }
}

create_temple_of_solkan_witch_hunter_effect = {
    random_list = {
        40 = {
            create_random_intriguer = {
                min_age = 25
                max_age = 50
                religion = classical_pantheon
                culture = reman
                female = 25
                health = 6.0
                random_traits = no
                add_trait = witch_hunter
                add_trait = creature_human
            }
        }
        20 = {
            create_random_intriguer = {
                min_age = 25
                max_age = 50
                religion = imperial_pantheon
                culture = sollander
                female = 25
                health = 6.0
                random_traits = no
                add_trait = witch_hunter
                add_trait = creature_human
            }
        }
    }
    new_character = {
        save_event_target_as = hunter_candidate
        set_character_flag = temple_of_solkan_witch_hunter
        witch_hunter_scarring_effect = yes
        change_martial = 1
        change_intrigue = 4
        change_learning = 1
        random = {
            chance = 70
            change_intrigue = 1
        }
        random = {
            chance = 70
            add_trait = cruel
        }
        random = {
            chance = 70
            add_trait = stubborn
        }
        random = {
            chance = 50
            add_trait = shrewd
        }
        random = {
            chance = 40
            add_trait = diligent
        }
        random = {
            chance = 40
            add_trait = patient
        }
        random_list = {
            20 = {
                add_trait = impaler
            }
            20 = {
                add_trait = schemer
            }
        }
    }
}

create_emissary_of_order_witch_hunter_effect = {
    create_random_intriguer = {
        min_age = 25
        max_age = 50
        religion = ormazd
        culture = cophic
        female = no
        health = 7.0
        random_traits = no
        add_trait = witch_hunter
        add_trait = creature_human
        add_trait = arabyan_scholar
        add_trait = eunuch
    }
    new_character = {
        save_event_target_as = hunter_candidate
        set_character_flag = emissary_of_order_witch_hunter
        witch_hunter_scarring_effect = yes
        change_diplomacy = 3
        change_martial = 8
        change_intrigue = 8
        change_stewardship = 3
        change_learning = 5
        random_list = {
            15 = {
                add_trait = magic_potential_3
            }
            5 = {
                add_trait = magic_potential_4
            }
        }
        random_list = {
            10 = {
                add_trait = light_elemental
            }
            10 = {
                add_trait = light_mystical
            }
            10 = {
                add_trait = light_cardinal
            }
        }
        random_list = {
            10 = {
                add_trait = quick
            }
            10 = {
                add_trait = brilliant
            }
            10 = {
                add_trait = genius
            }
        }
        random_list = {
            20 = {
                add_trait = mystic
            }
            20 = {
                add_trait = scholar
            }
        }
        random = {
            chance = 70
            add_trait = robust
        }
        random = {
            chance = 70
            add_trait = patient
        }
        random = {
            chance = 50
            add_trait = diligent
        }
        random = {
            chance = 40
            add_trait = just
        }
        random = {
            chance = 40
            add_trait = holy_warrior
        }
    }
}
###Hunter employment effects end###

#cult leader scope
find_starting_cultic_activity_kingdom_target_effect = {
    random_list = {
        #40% of the time, a Cult will start targeting their home Kingdom
        #this means that experienced players will copme to expect certain locations to have Cult problems, but not know for sure
        40 = {
            location = {
                kingdom = {
                    save_event_target_as = target_kingdom
                }
            }
        }
        #in 40% of other cases, the Cult will start targeting a de jure Kingdom in their home Empire
        #this result may lead them back to their home Kingdom
        50 = {
            location = {
                empire = {
                    random_direct_de_jure_vassal_title = {
                        limit = {
                            tier = KING
                            is_titular = no
                            NOT = {
                                holder_scope = {
                                    OR = {
                                        religion_group = chaos_gods_group
                                        religion_group = necromantic_group
                                    }
                                }
                            }
                        }
                        save_event_target_as = target_kingdom
                    }
                }
            }
        }
        #there's a 20% chance that the cult will start targetting somewhat randomly
        #again, it's possible for this result to lead back to the home Kingdom/Empire
        10 = {
            #Chaos Cults - not in Bretonnia
            if = {
                limit = {
                    religion_group = chaos_gods_group
                }
                random_landed_title = {
                    limit = {
                        tier = KING
                        is_titular = no
                        OR = {
                            de_jure_liege_or_above = e_kislev
                            de_jure_liege_or_above = e_the_empire
                            de_jure_liege_or_above = e_estalia
                            de_jure_liege_or_above = e_tilea
                            de_jure_liege_or_above = e_borderlands
                        }
                        NOT = {
                            holder_scope = {
                                OR = {
                                    religion_group = chaos_gods_group
                                    religion_group = necromantic_group
                                }
                            }
                        }
                    }
                    save_event_target_as = target_kingdom
                }
            }
            #Blood Dragons - focus on Bretonnia
            else_if = {
                limit = {
                    culture = blooddragons_culture
                }
                random_landed_title = {
                    limit = {
                        tier = KING
                        is_titular = no
                        de_jure_liege_or_above = e_bretonnia
                        NOT = {
                            holder_scope = {
                                OR = {
                                    religion_group = chaos_gods_group
                                    religion_group = necromantic_group
                                }
                            }
                        }
                    }
                    save_event_target_as = target_kingdom
                }
            }
            #Other necromantic people - not in Tilea (Cult oF Morr's homeland)
            else_if = {
                limit = {
                    religion_group = necromantic_group
                }
                random_landed_title = {
                    limit = {
                        tier = KING
                        is_titular = no
                        OR = {
                            de_jure_liege_or_above = e_kislev
                            de_jure_liege_or_above = e_the_empire
                            de_jure_liege_or_above = e_bretonnia
                            de_jure_liege_or_above = e_estalia
                            de_jure_liege_or_above = e_borderlands
                        }
                        NOT = {
                            holder_scope = {
                                OR = {
                                    religion_group = chaos_gods_group
                                    religion_group = necromantic_group
                                }
                            }
                        }
                    }
                    save_event_target_as = target_kingdom
                }
            }
        }
    }
}

#cult leader scope
find_new_cultic_activity_kingdom_target_effect = {
    persistent_event_target:cultic_activity_target = {
        save_event_target_as = current_area_of_operations
    }
    #clear old influencing flags - 2 year window for witch hunts to wrap up before the trail goes cold
    any_province = {
        limit = {
            de_jure_liege_or_above = event_target:current_area_of_operations
        }
        province_event = {
            id = wh_cults_and_hunters.3
            days = 730
        }
    }
    random_list = {
        #shift targets in same de jure Empire
        30 = {
            event_target:current_area_of_operations = {
                empire = {
                    random_direct_de_jure_vassal_title = {
                        tier = KING
                        is_titular = no
                        NOR = {
                            title = event_target:current_area_of_operations
                            holder_scope = {
                                OR = {
                                    religion_group = chaos_gods_group
                                    religion_group = necromantic_group
                                }
                            }
                        }
                    }
                    save_event_target_as = target_kingdom
                }
            }
            event_target:current_area_of_operations = {
                empire = {
                    random_direct_de_jure_vassal_title = {
                        limit = {
                            tier = KING
                            is_titular = no
                            NOR = {
                                title = event_target:current_area_of_operations
                                holder_scope = {
                                    OR = {
                                        religion_group = chaos_gods_group
                                        religion_group = necromantic_group
                                    }
                                }
                            }
                        }
                        save_event_target_as = target_kingdom
                    }
                }
            }
        }
        #return to base
        10 = {
            trigger = {
                location = {
                    kingdom = {
                        NOR = {
                            title = event_target:current_area_of_operations
                            holder_scope = {
                                OR = {
                                    religion_group = choas_gods_group
                                    religion_group = necromantic_group
                                }
                            }
                        }
                    }
                }
            }
            location = {
                kingdom = {
                    save_event_target_as = target_kingdom
                }
            }
        }
        #reset
        10 = {
            #Chaos Cults - not in Bretonnia
            if = {
                limit = {
                    religion_group = chaos_gods_group
                }
                random_landed_title = {
                    limit = {
                        tier = KING
                        is_titular = no
                        OR = {
                            de_jure_liege_or_above = e_kislev
                            de_jure_liege_or_above = e_the_empire
                            de_jure_liege_or_above = e_estalia
                            de_jure_liege_or_above = e_tilea
                            de_jure_liege_or_above = e_borderlands
                        }
                        NOR = {
                            title = event_target:current_area_of_operations
                            holder_scope = {
                                OR = {
                                    religion_group = chaos_gods_group
                                    religion_group = necromantic_group
                                }
                            }
                        }
                    }
                    save_event_target_as = target_kingdom
                }
            }
            #Blood Dragons - focus on Bretonnia
            else_if = {
                limit = {
                    culture = blooddragons_culture
                }
                random_landed_title = {
                    limit = {
                        tier = KING
                        is_titular = no
                        de_jure_liege_or_above = e_bretonnia
                        NOR = {
                            title = event_target:current_area_of_operations
                            holder_scope = {
                                OR = {
                                    religion_group = chaos_gods_group
                                    religion_group = necromantic_group
                                }
                            }
                        }
                    }
                    save_event_target_as = target_kingdom
                }
            }
            #Other necromantic people - not in Tilea (Cult oF Morr's homeland)
            else_if = {
                limit = {
                    religion_group = necromantic_group
                }
                random_landed_title = {
                    limit = {
                        tier = KING
                        is_titular = no
                        OR = {
                            de_jure_liege_or_above = e_kislev
                            de_jure_liege_or_above = e_the_empire
                            de_jure_liege_or_above = e_bretonnia
                            de_jure_liege_or_above = e_estalia
                            de_jure_liege_or_above = e_borderlands
                        }
                        NOR = {
                            title = event_target:current_area_of_operations
                            holder_scope = {
                                OR = {
                                    religion_group = chaos_gods_group
                                    religion_group = necromantic_group
                                }
                            }
                        }
                    }
                    save_event_target_as = target_kingdom
                }
            }
        }
    }
}

#cult leader scope
cultic_tactical_action_effect = {
    save_event_target_as = active_cult_leader
    #clean up flags from previous action
    clr_character_flag = consolidating_influence
    clr_character_flag = building_influence
    clr_character_flag = gathering_resources
    clr_character_flag = inspiring_killings
    clr_character_flag = spawning_disease
    clr_character_flag = encouraging_decadence
    clr_character_flag = weaving_plots
    random_list = {
        #consolidate
        20 = {
            modifier = {
                factor = 2
                ai_ambition < -50
            }
            #gives resistance to Witch Hunter activity
            set_character_flag = consolidating_influence
            change_variable = {
                which = cultic_influence
                value = 2
            }
            #"quiet" effect so influence can build with lower risk of alerting hunters
            random = {
                chance = 15
                cultic_activity_leaves_clues_effect = yes
            }
        }
        #build influence
        40 = {
            trigger = {
                wealth > 50
            }
            wealth = -5
            change_variable = {
                which = cultic_influence
                value = 4
            }
            set_character_flag = building_influence
            random = {
                chance = 70
                cultic_activity_leaves_clues_effect = yes
            }
        }
        #gather resources
        20 = {
            trigger = {
                check_variable = {
                    which = cultic_influence
                    value = 10
                }
            }
            modifier = {
                factor = 2
                ai_greed > 50
            }
            modifier = {
                factor = 3
                wealth < 250
            }
            modifier = {
                factor = 5
                wealth < 100
            }
            set_character_flag = gathering_resources
            wealth = 20
            random = {
                chance = 50
                cultic_activity_leaves_clues_effect = yes
            }
        }
        #inspire killings (khorne)
        15 = {
            trigger = {
                OR = {
                    religion = chaos
                    religion = khorne
                }
                check_variable = {
                    which = cultic_influence
                    value = 10
                }
            }
            set_character_flag = inspiring_killings
            add_offmap_currency = {
                offmap = khorne_warp
                value = 100
            }
            random = {
                chance = 80
                cultic_activity_leaves_clues_effect = yes
            }
        }
        #spawn contagion (nurgle)
        15 = {
            trigger = {
                OR = {
                    religion = chaos
                    religion = nurgle
                }
                check_variable = {
                    which = cultic_influence
                    value = 10
                }
            }
            set_character_flag = spawning_disease
            add_offmap_currency = {
                offmap = nurgle_warp
                value = 100
            }
            random = {
                chance = 80
                cultic_activity_leaves_clues_effect = yes
            }
        }
        #encourage decadence (slaanesh)
        15 = {
            trigger = {
                OR = {
                    religion = chaos
                    religion = slaanesh
                }
                check_variable = {
                    which = cultic_influence
                    value = 10
                }
            }
            set_character_flag = encouraging_decadence
            add_offmap_currency = {
                offmap = slaanesh_warp
                value = 100
            }
            random = {
                chance = 80
                cultic_activity_leaves_clues_effect = yes
            }
        }
        #weave plots (tzeentch)
        15 = {
            trigger = {
                OR = {
                    religion = chaos
                    religion = tzeentch
                }
                check_variable = {
                    which = cultic_influence
                    value = 10
                }
            }
            set_character_flag = weaving_plots
            add_offmap_currency = {
                offmap = tzeentch_warp
                value = 100
            }
            random = {
                chance = 80
                cultic_activity_leaves_clues_effect = yes
            }
        }
        #chaos cult instigate revolt
        20 = {
            trigger = {
                religion_group = chaos_gods_group
                wealth > 250
                check_variable = {
                    which = cultic_influence
                    value = 150
                }
            }
            modifier = {
                factor = 0.5
                trait = content
            }
            modifier = {
                factor = 1.5
                trait = ambitious
            }
            wealth = -200
            divide_variable = {
                which = cultic_influence
                value = 5
            }
            #count revolts
            change_variable = {
                which = revolts_launched
                value = 1
            }
            #spawn revolt
            random_province = {
                limit = {
                    de_jure_liege_or_above = event_target:cultic_area_of_operations
                    religion_group = old_world_group
                    NOR = {
                        has_province_modifier = terrorized_by_witch_hunter
                        has_province_modifier = touch_of_the_law_god
                        has_province_modifier = verenan_order
                        has_province_modifier = recent_county_uprising
                    }
                }
                province_event = {
                    id = wh_cults_and_hunters.401
                    days = 45
                    random = 45
                }
            }
            #please the Gods
            add_doom_progress_tiny_effect = yes
            #scuttle away!
            find_new_cultic_activity_kingdom_target_effect = yes
            save_persistent_event_target = {
                name = cultic_activity_target
                scope = event_target:target_kingdom
            }
        }
        #cult vs. cult
        50 = {
            trigger = {
                any_title = {
                    limit = {
                        has_title_flag = underground_cult
                        holder_scope = {
                            persistent_event_target:cultic_activity_target = {
                                title = event_target:cultic_area_of_operations
                            }
                        }
                    }
                }
            }
            wealth = -50
            subtract_variable = {
                which = cultic_influence
                value = 50
            }
            random_title = {
                limit = {
                    has_title_flag = underground_cult
                    holder_scope = {
                        persistent_event_target:cultic_activity_target = {
                            title = event_target:cultic_area_of_operations
                        }
                    }
                }
                wealth = -50
                subtract_variable = {
                    which = cultic_influence
                    value = 50
                }
            }
        }
        #TODO
        #undead uprising
        #blood dragon... thing?
    }
    subtract_variable = {
        which = cult_tactical_actions
        value = 1
    }
}

#cult leader scope
cultic_activity_leaves_clues_effect = {
    random_province = {
        limit = {
            de_jure_liege_or_above = event_target:cultic_area_of_operations
            religion_group = old_world_group
        }
        save_event_target_as = clue_county
    }
    #hit from emergency measures
    if = {
        limit = {
            event_target:clue_county = {
                holder_scope = {
                    has_law = witch_hunter_law_3
                }
            }
        }
        subtract_variable = {
            which = cultic_influence
            value = 3
        }
    }
    #hit from Shallyan Prosperity
    if = {
        limit = {
            event_target:clue_county = {
                holder_scope = {
                    has_character_modifier = shallyan_prosperity_modifier
                }
            }
        }
        subtract_variable = {
            which = cultic_influence
            value = 2
        }
    }
    ## Now check if action is possible ##
    #check for Law Bombs
    if = {
        limit = {
            event_target:clue_county = {
                 has_province_modifier = touch_of_the_law_god
            }
        }
        subtract_variable = {
            which = cultic_influence
            value = 8
        }
    }
    #check for hunter bombs
    else_if = {
        limit = {
            event_target:clue_county = {
                 has_province_modifier = terrorized_by_witch_hunter
            }
        }
        subtract_variable = {
            which = cultic_influence
            value = 5
        }
    }
    #check for Verena's protection
    else_if = {
        limit = {
            event_target:clue_county = {
                 has_province_modifier = verenan_order
            }
        }
        subtract_variable = {
            which = cultic_influence
            value = 1
        }
    }
    #otherwise get on with your dark deeds
    else = {
        random_list = {
            #extortion
            50 = {
                modifier = {
                    factor = 3
                    OR = {
                        has_character_flag = gathering_resources
                        has_character_flag = building_influence
                    }
                }
                event_target:clue_county = {
                    random_list = {
                        25 = {
                            add_province_modifier = {
                                name = clue_extortion_cultic
                                duration = 365
                            }
                        }
                        50 = {
                            add_province_modifier = {
                                name = clue_extortion_cultic
                                duration = 730
                            }
                        }
                        25 = {
                            add_province_modifier = {
                                name = clue_extortion_cultic
                                duration = 1095
                            }
                        }
                    }
                }
            }
            #strange rites
            10 = {
                modifier = {
                    factor = 2
                    religion = tzeentch
                }
                modifier = {
                    factor = 5
                    has_character_flag = weaving_plots
                }
                event_target:clue_county = {
                    random_list = {
                        25 = {
                            add_province_modifier = {
                                name = clue_rituals_cultic
                                duration = 365
                            }
                        }
                        50 = {
                            add_province_modifier = {
                                name = clue_rituals_cultic
                                duration = 730
                            }
                            random_province_character = {
                                limit = {
                                    age > 15
                                    cults_grace_period_trigger = yes
                                    NOR = {
                                        trait = underground_cult_member
                                        has_character_flag = invited_to_cultic_rite
                                    }
                                }
                                random = {
                                    chance = 75
                                    set_character_flag = invited_to_cultic_rite
                                    character_event = {
                                        id = wh_cults_and_hunters.251
                                        days = 372
                                        random = 30
                                    }
                                }
                            }
                        }
                        25 = {
                            add_province_modifier = {
                                name = clue_rituals_cultic
                                duration = 1095
                            }
                            random_province_character = {
                                limit = {
                                    age > 15
                                    cults_grace_period_trigger = yes
                                    NOR = {
                                        trait = underground_cult_member
                                        has_character_flag = invited_to_cultic_rite
                                    }
                                }
                                random = {
                                    chance = 75
                                    set_character_flag = invited_to_cultic_rite
                                    character_event = {
                                        id = wh_cults_and_hunters.251
                                        days = 372
                                        random = 30
                                    }
                                }
                            }
                            random_province_character = {
                                limit = {
                                    age > 15
                                    cults_grace_period_trigger = yes
                                    NOR = {
                                        trait = underground_cult_member
                                        has_character_flag = invited_to_cultic_rite
                                    }
                                }
                                random = {
                                    chance = 75
                                    set_character_flag = invited_to_cultic_rite
                                    character_event = {
                                        id = wh_cults_and_hunters.251
                                        days = 737
                                        random = 60
                                    }
                                }
                            }
                        }
                    }
                    random_province_character = {
                        limit = {
                            age > 15
                            cults_grace_period_trigger = yes
                            NOR = {
                                trait = underground_cult_member
                                has_character_flag = invited_to_cultic_rite
                            }
                        }
                        random = {
                            chance = 75
                            set_character_flag = invited_to_cultic_rite
                            character_event = {
                                id = wh_cults_and_hunters.251
                                days = 7
                                random = 7
                            }
                        }
                    }
                }
            }
            #abductions
            10 = {
                modifier = {
                    factor = 3
                    OR = {
                        has_character_flag = gathering_resources
                        has_character_flag = building_influence
                    }
                }
                event_target:clue_county = {
                    random_list = {
                        25 = {
                            add_province_modifier = {
                                name = clue_abductions_cultic
                                duration = 365
                            }
                        }
                        50 = {
                            add_province_modifier = {
                                name = clue_abductions_cultic
                                duration = 730
                            }
                            random_province_character = {
                                limit = {
                                    age > 15
                                    cults_grace_period_trigger = yes
                                    NOR = {
                                        trait = underground_cult_member
                                        has_character_flag = stalked_by_cultic_kidnappers
                                    }
                                }
                                random = {
                                    chance = 75
                                    set_character_flag = stalked_by_cultic_kidnappers
                                    character_event = {
                                        id = wh_cults_and_hunters.281
                                        days = 372
                                        random = 30
                                    }
                                }
                            }
                        }
                        25 = {
                            add_province_modifier = {
                                name = clue_abductions_cultic
                                duration = 1095
                            }
                            random_province_character = {
                                limit = {
                                    age > 15
                                    cults_grace_period_trigger = yes
                                    NOR = {
                                        trait = underground_cult_member
                                        has_character_flag = stalked_by_cultic_kidnappers
                                    }
                                }
                                random = {
                                    chance = 75
                                    set_character_flag = stalked_by_cultic_kidnappers
                                    character_event = {
                                        id = wh_cults_and_hunters.281
                                        days = 372
                                        random = 30
                                    }
                                }
                            }
                            random_province_character = {
                                limit = {
                                    age > 15
                                    cults_grace_period_trigger = yes
                                    NOR = {
                                        trait = underground_cult_member
                                        has_character_flag = stalked_by_cultic_kidnappers
                                    }
                                }
                                random = {
                                    chance = 75
                                    set_character_flag = stalked_by_cultic_kidnappers
                                    character_event = {
                                        id = wh_cults_and_hunters.281
                                        days = 737
                                        random = 60
                                    }
                                }
                            }
                        }
                    }
                    random_province_character = {
                        limit = {
                            age > 15
                            cults_grace_period_trigger = yes
                            NOR = {
                                trait = underground_cult_member
                                has_character_flag = stalked_by_cultic_kidnappers
                            }
                        }
                        random = {
                            chance = 75
                            set_character_flag = stalked_by_cultic_kidnappers
                            character_event = {
                                id = wh_cults_and_hunters.281
                                days = 7
                                random = 7
                            }
                        }
                    }
                }
            }
            #murders
            10 = {
                modifier = {
                    factor = 2
                    religion = khorne
                }
                modifier = {
                    factor = 5
                    has_character_flag = inspiring_killings
                }
                event_target:clue_county = {
                    random_list = {
                        25 = {
                            add_province_modifier = {
                                name = clue_murders_cultic
                                duration = 365
                            }
                        }
                        50 = {
                            add_province_modifier = {
                                name = clue_murders_cultic
                                duration = 730
                            }
                            random_province_character = {
                                limit = {
                                    age > 15
                                    cults_grace_period_trigger = yes
                                    NOR = {
                                        trait = underground_cult_member
                                        has_character_flag = stalked_by_cultic_killer
                                    }
                                }
                                random = {
                                    chance = 75
                                    set_character_flag = stalked_by_cultic_killer
                                    character_event = {
                                        id = wh_cults_and_hunters.271
                                        days = 372
                                        random = 30
                                    }
                                }
                            }
                        }
                        25 = {
                            add_province_modifier = {
                                name = clue_murders_cultic
                                duration = 1095
                            }
                            random_province_character = {
                                limit = {
                                    age > 15
                                    cults_grace_period_trigger = yes
                                    NOR = {
                                        trait = underground_cult_member
                                        has_character_flag = stalked_by_cultic_killer
                                    }
                                }
                                random = {
                                    chance = 75
                                    set_character_flag = stalked_by_cultic_killer
                                    character_event = {
                                        id = wh_cults_and_hunters.271
                                        days = 372
                                        random = 30
                                    }
                                }
                            }
                            random_province_character = {
                                limit = {
                                    age > 15
                                    cults_grace_period_trigger = yes
                                    NOR = {
                                        trait = underground_cult_member
                                        has_character_flag = stalked_by_cultic_killer
                                    }
                                }
                                random = {
                                    chance = 75
                                    set_character_flag = stalked_by_cultic_killer
                                    character_event = {
                                        id = wh_cults_and_hunters.271
                                        days = 737
                                        random = 60
                                    }
                                }
                            }
                        }
                    }
                    random_province_character = {
                        limit = {
                            age > 15
                            cults_grace_period_trigger = yes
                            NOR = {
                                trait = underground_cult_member
                                has_character_flag = stalked_by_cultic_killer
                            }
                        }
                        random = {
                            chance = 75
                            set_character_flag = stalked_by_cultic_killer
                            character_event = {
                                id = wh_cults_and_hunters.271
                                days = 7
                                random = 7
                            }
                        }
                    }
                }
            }
            #contagion
            10 = {
                modifier = {
                    factor = 2
                    religion = nurgle
                }
                modifier = {
                    factor = 5
                    has_character_flag = spawning_disease
                }
                random_list = {
                    25 = {
                        event_target:clue_county = {
                            add_province_modifier = {
                                name = clue_contagion_cultic
                                duration = 365
                            }
                        }
                    }
                    50 = {
                        event_target:clue_county = {
                            add_province_modifier = {
                                name = clue_contagion_cultic
                                duration = 730
                            }
                            random_province_character = {
                                limit = {
                                    age > 15
                                    cults_grace_period_trigger = yes
                                    NOR = {
                                        trait = underground_cult_member
                                        has_character_flag = accosted_by_contagious_cultist
                                    }
                                }
                                random = {
                                    chance = 75
                                    set_character_flag = accosted_by_contagious_cultist
                                    character_event = {
                                        id = wh_cults_and_hunters.291
                                        days = 372
                                        random = 30
                                    }
                                }
                            }
                        }
                    }
                    25 = {
                        event_target:clue_county = {
                            add_province_modifier = {
                                name = clue_contagion_cultic
                                duration = 1095
                            }
                            random_province_character = {
                                limit = {
                                    age > 15
                                    cults_grace_period_trigger = yes
                                    NOR = {
                                        trait = underground_cult_member
                                        has_character_flag = accosted_by_contagious_cultist
                                    }
                                }
                                random = {
                                    chance = 75
                                    set_character_flag = accosted_by_contagious_cultist
                                    character_event = {
                                        id = wh_cults_and_hunters.291
                                        days = 372
                                        random = 30
                                    }
                                }
                            }
                            random_province_character = {
                                limit = {
                                    age > 15
                                    cults_grace_period_trigger = yes
                                    NOR = {
                                        trait = underground_cult_member
                                        has_character_flag = accosted_by_contagious_cultist
                                    }
                                }
                                random = {
                                    chance = 75
                                    set_character_flag = accosted_by_contagious_cultist
                                    character_event = {
                                        id = wh_cults_and_hunters.291
                                        days = 737
                                        random = 60
                                    }
                                }
                            }
                        }
                    }
                }
                event_target:clue_county = {
                    random_province_character = {
                        limit = {
                            age > 15
                            cults_grace_period_trigger = yes
                            NOR = {
                                trait = underground_cult_member
                                has_character_flag = accosted_by_contagious_cultist
                            }
                        }
                        random = {
                            chance = 75
                            set_character_flag = accosted_by_contagious_cultist
                            character_event = {
                                id = wh_cults_and_hunters.291
                                days = 7
                                random = 7
                            }
                        }
                    }
                }
            }
            #excessive celebration
            10 = {
                modifier = {
                    factor = 2
                    religion = slaanesh
                }
                modifier = {
                    factor = 5
                    has_character_flag = encouraging_decadence
                }
                event_target:clue_county = {
                    random_list = {
                        25 = {
                            add_province_modifier = {
                                name = clue_celebration_cultic
                                duration = 365
                            }
                        }
                        50 = {
                            add_province_modifier = {
                                name = clue_celebration_cultic
                                duration = 730
                            }
                            random_province_character = {
                                limit = {
                                    age > 15
                                    cults_grace_period_trigger = yes
                                    NOR = {
                                        trait = underground_cult_member
                                        has_character_flag = invited_to_cultic_party
                                    }
                                }
                                random = {
                                    chance = 75
                                    set_character_flag = invited_to_cultic_party
                                    character_event = {
                                        id = wh_cults_and_hunters.261
                                        days = 372
                                        random = 30
                                    }
                                }
                            }
                        }
                        25 = {
                            add_province_modifier = {
                                name = clue_celebration_cultic
                                duration = 1095
                            }
                            random_province_character = {
                                limit = {
                                    age > 15
                                    cults_grace_period_trigger = yes
                                    NOR = {
                                        trait = underground_cult_member
                                        has_character_flag = invited_to_cultic_party
                                    }
                                }
                                random = {
                                    chance = 75
                                    set_character_flag = invited_to_cultic_party
                                    character_event = {
                                        id = wh_cults_and_hunters.261
                                        days = 372
                                        random = 30
                                    }
                                }
                            }
                            random_province_character = {
                                limit = {
                                    age > 15
                                    cults_grace_period_trigger = yes
                                    NOR = {
                                        trait = underground_cult_member
                                        has_character_flag = invited_to_cultic_party
                                    }
                                }
                                random = {
                                    chance = 75
                                    set_character_flag = invited_to_cultic_party
                                    character_event = {
                                        id = wh_cults_and_hunters.261
                                        days = 737
                                        random = 60
                                    }
                                }
                            }
                        }
                    }
                    random_province_character = {
                        limit = {
                            age > 15
                            cults_grace_period_trigger = yes
                            NOR = {
                                trait = underground_cult_member
                                has_character_flag = invited_to_cultic_party
                            }
                        }
                        random = {
                            chance = 75
                            set_character_flag = invited_to_cultic_party
                            character_event = {
                                id = wh_cults_and_hunters.261
                                days = 7
                                random = 7
                            }
                        }
                    }
                }
            }
        }
        #set up dynamic flag for player's decision-based witch hunting
        event_target:cult_identity = {
            #clear, then set the dynamic flag so that had_province_flag functions properly
            clr_title_flag = cult_is_influencing_@event_target:clue_county
            set_title_flag = cult_is_influencing_@event_target:clue_county
        }
        event_target:clue_county = {
            set_province_flag = cultic_activity
            witch_hunter_response_to_clues_effect = yes
        }
    }
}

#old world playable scope
generate_new_false_clues_effect = {
    if = {
        limit = {
            num_of_count_titles = 7
        }
        random = {
            chance = 60
            random_demesne_province = {
                false_clues_appear_effect = yes
            }
        }
        random = {
            chance = 45
            random_demesne_province = {
                false_clues_appear_effect = yes
            }
        }
    }
    else_if = {
        limit = {
            num_of_count_titles = 5
        }
        random = {
            chance = 45
            random_demesne_province = {
                false_clues_appear_effect = yes
            }
        }
        random = {
            chance = 20
            random_demesne_province = {
                false_clues_appear_effect = yes
            }
        }
    }
    else_if = {
        limit = {
            num_of_count_titles = 3
        }
        random = {
            chance = 45
            random_demesne_province = {
                false_clues_appear_effect = yes
            }
        }
    }
    else = {
        random = {
            chance = 15
            random_demesne_province = {
                false_clues_appear_effect = yes
            }
        }
    }
}

#province scope
false_clues_appear_effect = {
    save_event_target_as = clue_county
    #even though these things could happen in a purged province, the point of false clues is that they look like regular clues
    if = {
        limit = {
            NOR = {
                has_province_modifier = touch_of_the_law_god
                has_province_modifier = terrorized_by_witch_hunter
                has_province_modifier = verenan_order
            }
        }
        random_list = {
            #Extortion
            50 = {
                add_province_modifier = {
                    name = clue_extortion_normal
                    duration = 365
                }
            }
            50 = {
                add_province_modifier = {
                    name = clue_extortion_normal
                    duration = 730
                }
            }
            50 = {
                add_province_modifier = {
                    name = clue_extortion_normal
                    duration = 1095
                }
            }
            #Secret Rites
            10 = {
                add_province_modifier = {
                    name = clue_rituals_normal
                    duration = 365
                }
                random_province_character = {
                    limit = {
                        age > 15
                        cults_grace_period_trigger = yes
                        NOR = {
                            trait = underground_cult_member
                            has_character_flag = invited_to_secret_rite
                        }
                    }
                    random = {
                        chance = 75
                        set_character_flag = invited_to_secret_rite
                        character_event = {
                            id = wh_cults_and_hunters.251
                            days = 7
                            random = 7
                        }
                    }
                }
            }
            10 = {
                add_province_modifier = {
                    name = clue_rituals_normal
                    duration = 730
                }
                random_province_character = {
                    limit = {
                        age > 15
                        cults_grace_period_trigger = yes
                        NOR = {
                            trait = underground_cult_member
                            has_character_flag = invited_to_secret_rite
                        }
                    }
                    random = {
                        chance = 75
                        set_character_flag = invited_to_secret_rite
                        character_event = {
                            id = wh_cults_and_hunters.251
                            days = 7
                            random = 7
                        }
                    }
                }
                random_province_character = {
                    limit = {
                        age > 15
                        cults_grace_period_trigger = yes
                        NOR = {
                            trait = underground_cult_member
                            has_character_flag = invited_to_secret_rite
                        }
                    }
                    random = {
                        chance = 75
                        set_character_flag = invited_to_secret_rite
                        character_event = {
                            id = wh_cults_and_hunters.251
                            days = 372
                            random = 30
                        }
                    }
                }
            }
            10 = {
                add_province_modifier = {
                    name = clue_rituals_normal
                    duration = 1095
                }
                random_province_character = {
                    limit = {
                        age > 15
                        cults_grace_period_trigger = yes
                        NOR = {
                            trait = underground_cult_member
                            has_character_flag = invited_to_secret_rite
                        }
                    }
                    random = {
                        chance = 75
                        set_character_flag = invited_to_secret_rite
                        character_event = {
                            id = wh_cults_and_hunters.251
                            days = 7
                            random = 7
                        }
                    }
                }
                random_province_character = {
                    limit = {
                        age > 15
                        cults_grace_period_trigger = yes
                        NOR = {
                            trait = underground_cult_member
                            has_character_flag = invited_to_secret_rite
                        }
                    }
                    random = {
                        chance = 75
                        set_character_flag = invited_to_secret_rite
                        character_event = {
                            id = wh_cults_and_hunters.251
                            days = 372
                            random = 30
                        }
                    }
                }
                random_province_character = {
                    limit = {
                        age > 15
                        cults_grace_period_trigger = yes
                        NOR = {
                            trait = underground_cult_member
                            has_character_flag = invited_to_secret_rite
                        }
                    }
                    random = {
                        chance = 75
                        set_character_flag = invited_to_secret_rite
                        character_event = {
                            id = wh_cults_and_hunters.251
                            days = 737
                            random = 60
                        }
                    }
                }
            }
            #Abductions
            10 = {
                add_province_modifier = {
                    name = clue_abductions_normal
                    duration = 365
                }
                random_province_character = {
                    limit = {
                        age > 15
                        cults_grace_period_trigger = yes
                        NOR = {
                            trait = underground_cult_member
                            has_character_flag = stalked_by_criminal_kidnappers
                        }
                    }
                    random = {
                        chance = 75
                        set_character_flag = stalked_by_criminal_kidnappers
                        character_event = {
                            id = wh_cults_and_hunters.281
                            days = 7
                            random = 7
                        }
                    }
                }
            }
            10 = {
                add_province_modifier = {
                    name = clue_abductions_normal
                    duration = 730
                }
                random_province_character = {
                    limit = {
                        age > 15
                        cults_grace_period_trigger = yes
                        NOR = {
                            trait = underground_cult_member
                            has_character_flag = stalked_by_criminal_kidnappers
                        }
                    }
                    random = {
                        chance = 75
                        set_character_flag = stalked_by_criminal_kidnappers
                        character_event = {
                            id = wh_cults_and_hunters.281
                            days = 7
                            random = 7
                        }
                    }
                }
                random_province_character = {
                    limit = {
                        age > 15
                        cults_grace_period_trigger = yes
                        NOR = {
                            trait = underground_cult_member
                            has_character_flag = stalked_by_criminal_kidnappers
                        }
                    }
                    random = {
                        chance = 75
                        set_character_flag = stalked_by_criminal_kidnappers
                        character_event = {
                            id = wh_cults_and_hunters.281
                            days = 372
                            random = 30
                        }
                    }
                }
            }
            10 = {
                add_province_modifier = {
                    name = clue_abductions_normal
                    duration = 1095
                }
                random_province_character = {
                    limit = {
                        age > 15
                        cults_grace_period_trigger = yes
                        NOR = {
                            trait = underground_cult_member
                            has_character_flag = stalked_by_criminal_kidnappers
                        }
                    }
                    random = {
                        chance = 75
                        set_character_flag = stalked_by_criminal_kidnappers
                        character_event = {
                            id = wh_cults_and_hunters.281
                            days = 7
                            random = 7
                        }
                    }
                }
                random_province_character = {
                    limit = {
                        age > 15
                        cults_grace_period_trigger = yes
                        NOR = {
                            trait = underground_cult_member
                            has_character_flag = stalked_by_criminal_kidnappers
                        }
                    }
                    random = {
                        chance = 75
                        set_character_flag = stalked_by_criminal_kidnappers
                        character_event = {
                            id = wh_cults_and_hunters.281
                            days = 372
                            random = 30
                        }
                    }
                }
                random_province_character = {
                    limit = {
                        age > 15
                        cults_grace_period_trigger = yes
                        NOR = {
                            trait = underground_cult_member
                            has_character_flag = stalked_by_criminal_kidnappers
                        }
                    }
                    random = {
                        chance = 75
                        set_character_flag = stalked_by_criminal_kidnappers
                        character_event = {
                            id = wh_cults_and_hunters.281
                            days = 3737
                            random = 60
                        }
                    }
                }
            }
            #Murders
            10 = {
                add_province_modifier = {
                    name = clue_murders_normal
                    duration = 365
                }
                random_province_character = {
                    limit = {
                        age > 15
                        cults_grace_period_trigger = yes
                        NOR = {
                            trait = underground_cult_member
                            has_character_flag = stalked_by_secret_killer
                        }
                    }
                    random = {
                        chance = 75
                        set_character_flag = stalked_by_secret_killer
                        character_event = {
                            id = wh_cults_and_hunters.271
                            days = 7
                            random = 7
                        }
                    }
                }
            }
            10 = {
                add_province_modifier = {
                    name = clue_murders_normal
                    duration = 730
                }
                random_province_character = {
                    limit = {
                        age > 15
                        cults_grace_period_trigger = yes
                        NOR = {
                            trait = underground_cult_member
                            has_character_flag = stalked_by_secret_killer
                        }
                    }
                    random = {
                        chance = 75
                        set_character_flag = stalked_by_secret_killer
                        character_event = {
                            id = wh_cults_and_hunters.271
                            days = 7
                            random = 7
                        }
                    }
                }
                random_province_character = {
                    limit = {
                        age > 15
                        cults_grace_period_trigger = yes
                        NOR = {
                            trait = underground_cult_member
                            has_character_flag = stalked_by_secret_killer
                        }
                    }
                    random = {
                        chance = 75
                        set_character_flag = stalked_by_secret_killer
                        character_event = {
                            id = wh_cults_and_hunters.271
                            days = 372
                            random = 30
                        }
                    }
                }
            }
            10 = {
                add_province_modifier = {
                    name = clue_murders_normal
                    duration = 1095
                }
                random_province_character = {
                    limit = {
                        age > 15
                        cults_grace_period_trigger = yes
                        NOR = {
                            trait = underground_cult_member
                            has_character_flag = stalked_by_secret_killer
                        }
                    }
                    random = {
                        chance = 75
                        set_character_flag = stalked_by_secret_killer
                        character_event = {
                            id = wh_cults_and_hunters.271
                            days = 7
                            random = 7
                        }
                    }
                }
                random_province_character = {
                    limit = {
                        age > 15
                        cults_grace_period_trigger = yes
                        NOR = {
                            trait = underground_cult_member
                            has_character_flag = stalked_by_secret_killer
                        }
                    }
                    random = {
                        chance = 75
                        set_character_flag = stalked_by_secret_killer
                        character_event = {
                            id = wh_cults_and_hunters.271
                            days = 372
                            random = 30
                        }
                    }
                }
                random_province_character = {
                    limit = {
                        age > 15
                        cults_grace_period_trigger = yes
                        NOR = {
                            trait = underground_cult_member
                            has_character_flag = stalked_by_secret_killer
                        }
                    }
                    random = {
                        chance = 75
                        set_character_flag = stalked_by_secret_killer
                        character_event = {
                            id = wh_cults_and_hunters.271
                            days = 737
                            random = 60
                        }
                    }
                }
            }
            #Contagion
            10 = {
                add_province_modifier = {
                    name = clue_contagion_normal
                    duration = 365
                }
                random_province_character = {
                    limit = {
                        age > 15
                        cults_grace_period_trigger = yes
                        NOR = {
                            trait = underground_cult_member
                            has_character_flag = accosted_by_contagious_peasant
                        }
                    }
                    random = {
                        chance = 75
                        set_character_flag = accosted_by_contagious_peasant
                        character_event = {
                            id = wh_cults_and_hunters.291
                            days = 7
                            random = 7
                        }
                    }
                }
            }
            10 = {
                add_province_modifier = {
                    name = clue_contagion_normal
                    duration = 730
                }
                random_province_character = {
                    limit = {
                        age > 15
                        cults_grace_period_trigger = yes
                        NOR = {
                            trait = underground_cult_member
                            has_character_flag = accosted_by_contagious_peasant
                        }
                    }
                    random = {
                        chance = 75
                        set_character_flag = accosted_by_contagious_peasant
                        character_event = {
                            id = wh_cults_and_hunters.291
                            days = 7
                            random = 7
                        }
                    }
                }
                random_province_character = {
                    limit = {
                        age > 15
                        cults_grace_period_trigger = yes
                        NOR = {
                            trait = underground_cult_member
                            has_character_flag = accosted_by_contagious_peasant
                        }
                    }
                    random = {
                        chance = 75
                        set_character_flag = accosted_by_contagious_peasant
                        character_event = {
                            id = wh_cults_and_hunters.291
                            days = 372
                            random = 30
                        }
                    }
                }
            }
            10 = {
                add_province_modifier = {
                    name = clue_contagion_normal
                    duration = 1095
                }
                random_province_character = {
                    limit = {
                        age > 15
                        cults_grace_period_trigger = yes
                        NOR = {
                            trait = underground_cult_member
                            has_character_flag = accosted_by_contagious_peasant
                        }
                    }
                    random = {
                        chance = 75
                        set_character_flag = accosted_by_contagious_peasant
                        character_event = {
                            id = wh_cults_and_hunters.291
                            days = 7
                            random = 7
                        }
                    }
                }
                random_province_character = {
                    limit = {
                        age > 15
                        cults_grace_period_trigger = yes
                        NOR = {
                            trait = underground_cult_member
                            has_character_flag = accosted_by_contagious_peasant
                        }
                    }
                    random = {
                        chance = 75
                        set_character_flag = accosted_by_contagious_peasant
                        character_event = {
                            id = wh_cults_and_hunters.291
                            days = 372
                            random = 30
                        }
                    }
                }
                random_province_character = {
                    limit = {
                        age > 15
                        cults_grace_period_trigger = yes
                        NOR = {
                            trait = underground_cult_member
                            has_character_flag = accosted_by_contagious_peasant
                        }
                    }
                    random = {
                        chance = 75
                        set_character_flag = accosted_by_contagious_peasant
                        character_event = {
                            id = wh_cults_and_hunters.291
                            days = 737
                            random = 60
                        }
                    }
                }
            }
            #Celebrations
            10 = {
                add_province_modifier = {
                    name = clue_celebration_normal
                    duration = 365
                }
                random_province_character = {
                    limit = {
                        age > 15
                        cults_grace_period_trigger = yes
                        NOT = {
                            has_character_flag = invited_to_secret_party
                        }
                    }
                    random = {
                        chance = 75
                        set_character_flag = invited_to_secret_party
                        character_event = {
                            id = wh_cults_and_hunters.261
                            days = 7
                            random = 7
                        }
                    }
                }
            }
            10 = {
                add_province_modifier = {
                    name = clue_celebration_normal
                    duration = 730
                }
                random_province_character = {
                    limit = {
                        age > 15
                        cults_grace_period_trigger = yes
                        NOT = {
                            has_character_flag = invited_to_secret_party
                        }
                    }
                    random = {
                        chance = 75
                        set_character_flag = invited_to_secret_party
                        character_event = {
                            id = wh_cults_and_hunters.261
                            days = 7
                            random = 7
                        }
                    }
                }
                random_province_character = {
                    limit = {
                        age > 15
                        cults_grace_period_trigger = yes
                        NOT = {
                            has_character_flag = invited_to_secret_party
                        }
                    }
                    random = {
                        chance = 75
                        set_character_flag = invited_to_secret_party
                        character_event = {
                            id = wh_cults_and_hunters.261
                            days = 372
                            random = 30
                        }
                    }
                }
            }
            10 = {
                add_province_modifier = {
                    name = clue_celebration_normal
                    duration = 1095
                }
                random_province_character = {
                    limit = {
                        age > 15
                        cults_grace_period_trigger = yes
                        NOT = {
                            has_character_flag = invited_to_secret_party
                        }
                    }
                    random = {
                        chance = 75
                        set_character_flag = invited_to_secret_party
                        character_event = {
                            id = wh_cults_and_hunters.261
                            days = 7
                            random = 7
                        }
                    }
                }
                random_province_character = {
                    limit = {
                        age > 15
                        cults_grace_period_trigger = yes
                        NOT = {
                            has_character_flag = invited_to_secret_party
                        }
                    }
                    random = {
                        chance = 75
                        set_character_flag = invited_to_secret_party
                        character_event = {
                            id = wh_cults_and_hunters.261
                            days = 372
                            random = 30
                        }
                    }
                }
                random_province_character = {
                    limit = {
                        age > 15
                        cults_grace_period_trigger = yes
                        NOT = {
                            has_character_flag = invited_to_secret_party
                        }
                    }
                    random = {
                        chance = 75
                        set_character_flag = invited_to_secret_party
                        character_event = {
                            id = wh_cults_and_hunters.261
                            days = 737
                            random = 60
                        }
                    }
                }
            }
        }
        witch_hunter_response_to_clues_effect = yes
    }
}

#cultist scope
underground_cultist_provides_influence_effect = {
    trigger_switch = {
        on_trigger = tier
        BARON = {
            event_target:active_cult_leader ={
                change_variable = {
                    which = cultic_influence
                    value = 2
                }
            }
        }
        COUNT = {
            event_target:active_cult_leader ={
                change_variable = {
                    which = cultic_influence
                    value = 3
                }
            }
        }
        DUKE = {
            event_target:active_cult_leader ={
                change_variable = {
                    which = cultic_influence
                    value = 5
                }
            }
        }
        KING = {
            event_target:active_cult_leader ={
                change_variable = {
                    which = cultic_influence
                    value = 8
                }
            }
        }
        EMPEROR = {
            event_target:active_cult_leader ={
                change_variable = {
                    which = cultic_influence
                    value = 12
                }
            }
        }
        fallback = {
            event_target:active_cult_leader ={
                change_variable = {
                    which = cultic_influence
                    value = 1
                }
            }
        }
    }
}

#potentially-corrupted character scope
corrupted_by_underground_cult_effect = {
    if = {
        limit = {
            religion_group = old_world_group
            has_secret_religion = no
        }
        set_character_flag = underground_cult_member #allows efficient pre-triggering
        add_trait = underground_cult_member #allows efficient scoping, but note that it's a random_ rather than an any_
        save_persistent_event_target = {
            name = underground_cult_allegiance
            scope = event_target:cult_identity
        }
        set_secret_religion = event_target:cult_leader
    }
}

#province scope
witch_hunter_response_to_clues_effect = {
    holder_scope = {
        if = {
            limit = {
                any_courtier_or_vassal = {
                    has_minor_title = title_court_witchhunter
                    trait = on_witch_hunt
                }
            }
            if = {
                limit = { ai = no }
                #notify player that there's trouble but their hunter's busy
            }
        }
        else_if = {
            limit = {
                any_courtier_or_vassal = {
                    has_minor_title = title_court_witchhunter
                }
            }
            random_courtier_or_vassal = {
                limit = {
                    has_minor_title = title_court_witchhunter
                }
                save_event_target_as = court_witchhunter
            }
            character_event = { id = wh_cults_and_hunters.610 }
        }
        else_if = {
            limit = {
                has_law = witch_hunter_law_0
            }
            random_courtier_or_vassal = {
                limit = {
                    has_job_title = job_spiritual
                }
                save_event_target_as = court_witchhunter
            }
            character_event = { id = wh_cults_and_hunters.610 }
        }
        #ai rulers without witch hunters may hire specialists
        else_if = {
            limit = {
                ai = yes
            }
            random = {
                chance = 65
                mult_modifier = {
                    factor = 1.4
                    has_law = witch_hunter_law_3
                }
                character_event = {
                    id = wh_cults_and_hunters.501
                }
            }
        }
        else = {
            #tell ai=no about happenings but don't pester them to do anything
        }
    }
}

#witch hunter employer scope
witch_hunt_begins_effect = {
    #Inquisitors are generally efficient
    if = {
        limit = {
            event_target:court_witchhunter = {
                OR = {
                    has_character_flag = sigmarite_templar_witch_hunter
                    has_character_flag = myrmidian_inquisitor_witch_hunter
                    has_character_flag = ice_witch_witch_hunter
                }
            }
        }
        character_event = {
            id = wh_cults_and_hunters.611
            days = 210
            random = 90
        }
    }
    ##specialists are very effective in their specific domain##
    #adventurers are best when there's no real cult activity
    else_if = {
        limit = {
            event_target:clue_county = {
                NOT = {
                    has_province_flag = cultic_activity
                }
            }
            event_target:court_witchhunter = {
                OR = {
                    has_character_flag = army_veteran_witch_hunter
                    has_character_flag = bold_scholar_witch_hunter
                    has_character_flag = crafty_spy_witch_hunter
                }
            }
        }
        character_event = {
            id = wh_cults_and_hunters.611
            days = 152
            random = 60
        }
    }
    #solkanites burn chaos
    else_if = {
        limit = {
            event_target:court_witchhunter = {
                has_character_flag = temple_of_solkan_witch_hunter
            }
            event_target:active_cult_leader = {
                true_religion_group = chaos_gods_group
            }
        }
        character_event = {
            id = wh_cults_and_hunters.611
            days = 152
            random = 60
        }
    }
    #order of the shroud burns necromantics
    else_if = {
        limit = {
            event_target:court_witchhunter = {
                has_character_flag = order_of_the_shroud_witch_hunter
            }
            event_target:active_cult_leader = {
                true_religion_group = necromantic_group
            }
        }
        character_event = {
            id = wh_cults_and_hunters.611
            days = 152
            random = 60
        }
    }
    #the emissary absolutely fries Chaos
    else_if = {
        limit = {
            event_target:court_witchhunter = {
                has_character_flag = emissary_of_order_witch_hunter
            }
            event_target:active_cult_leader = {
                true_religion_group = chaos_gods_group
            }
        }
        character_event = {
            id = wh_cults_and_hunters.611
            days = 60
            random = 60
        }
    }
    ##now that we've picked out hunter flags with special effects, trait only picks up hunters outside their specialty##
    else_if = {
        limit = {
            event_target:court_witchhunter = {
                trait = witch_hunter
            }
        }
        character_event = {
            id = wh_cults_and_hunters.611
            days = 275
            random = 180
        }
    }
    #the else case usually means that the court priest is doing the witch hunting
    else = {
        character_event = {
            id = wh_cults_and_hunters.611
            days = 550
            random = 360
        }
    }
}

#witch hunter employer scope
hurry_witch_hunt_effect = {
    #find event targets
    random_courtier_or_vassal = {
        limit = {
            trait = on_witch_hunt
        }
        save_event_target_as = court_witchhunter
    }
    event_target:court_witchhunter = {
        persistent_event_target:witch_hunt_county = {
            save_event_target_as = clue_county
        }
    }
    event_target:clue_county = {
        if = {
            limit = {
                has_province_flag = cultic_activity
            }
            random_title = {
                limit = {
                    has_title_flag = cult_is_influencing_@event_target:clue_county
                }
                holder_scope = {
                    save_event_target_as = active_cult_leader
                }
            }
        }
    }
    character_event = {
        id = wh_cults_and_hunters.611
        days = 3
        random = 3
    }
}

#witch hunter employer scope
witch_hunter_looks_for_deviant_courtiers_effect = {
    save_event_target_as = witch_hunter_employer
    random_list = {
        #cult member
        30 = {
            trigger = {
                any_realm_character = {
                    trait = underground_cult_member
                }
            }
            modifier = {
                factor = 2
                event_target:court_witchhunter = {
                    trait = witch_hunter
                }
            }
            modifier = {
                factor = 2
                event_target:court_witchhunter = {
                    intrigue = 15
                }
            }
            modifier = {
                factor = 2
                event_target:court_witchhunter = {
                    intrigue = 20
                }
            }
            random_realm_character = {
                limit = {
                    trait = underground_cult_member
                }
                accused_by_witch_hunter_effect = yes
            }
        }
        #mutant
        60 = {
            trigger = {
                any_realm_character = {
                    is_mutated_trigger = yes
                }
            }
            modifier = {
                factor = 2
                event_target:court_witchhunter = {
                    trait = witch_hunter
                }
            }
            random_realm_character = {
                limit = {
                    is_mutated_trigger = yes
                }
                accused_by_witch_hunter_effect = yes
            }
        }
        #illegal magic potential
        20 = {
            trigger = {
                has_law = magic_law_0
                any_realm_character = {
                    has_magic_potential = yes
                    OR = {
                        NOR = {
                            religion = grail
                            religion = kislev_gods
                        }
                        is_female = no
                    }
                }
            }
            modifier = {
                factor = 2
                event_target:court_witchhunter = {
                    trait = witch_hunter
                }
            }
            random_realm_character = {
                limit = {
                    has_magic_potential = yes
                    OR = {
                        NOR = {
                            religion = grail
                            religion = kislev_gods
                        }
                        is_female = no
                    }
                }
                accused_by_witch_hunter_effect = yes
            }
        }
        #Illegal magical training
        20 = {
            trigger = {
                has_law = magic_law_1
                any_realm_character = {
                    is_trained_mage = yes
                    OR = {
                        NOR = {
                            religion = grail
                            religion = kislev_gods
                        }
                        is_female = no
                    }
                }
            }
            modifier = {
                factor = 2
                event_target:court_witchhunter = {
                    trait = witch_hunter
                }
            }
            random_realm_character = {
                limit = {
                    is_trained_mage = yes
                    OR = {
                        NOR = {
                            religion = grail
                            religion = kislev_gods
                        }
                        is_female = no
                    }
                }
                accused_by_witch_hunter_effect = yes
            }
        }
        #Illegal magic - cumulative with other effects, so evil wizards are especially high priority targets
        20 = {
            trigger = {
                any_realm_character = {
                    OR = {
                        trait = lore_dark_magic
                        trait = lore_chaos
                        trait = lore_nurgle
                        trait = lore_slaanesh
                        trait = lore_tzeentch
                        trait = lore_necromancy
                    }
                }
            }
            modifier = {
                factor = 2
                event_target:court_witchhunter = {
                    trait = witch_hunter
                }
            }
            random_realm_character = {
                limit = {
                    OR = {
                        trait = lore_dark_magic
                        trait = lore_chaos
                        trait = lore_nurgle
                        trait = lore_slaanesh
                        trait = lore_tzeentch
                        trait = lore_necromancy
                    }
                }
                accused_by_witch_hunter_effect = yes
            }
        }
        #accuse innocent
        20 = {
            modifier = {
                factor = 0.8
                event_target:court_witchhunter = {
                    intrigue = 15
                }
            }
            modifier = {
                factor = 0.8
                event_target:court_witchhunter = {
                    intrigue = 20
                }
            }
            modifier = {
                factor = 1.5
                event_target:court_witchhunter = {
                    trait = arbitrary
                }
            }
            modifier = {
                factor = 2
                event_target:court_witchhunter = {
                    trait = paranoid
                }
            }
            modifier = {
                factor = 0
                event_target:court_witchhunter = {
                    has_character_flag = order_of_the_sword_and_scale_witch_hunter
                }
            }
            random_realm_character = {
                accused_by_witch_hunter_effect = yes
            }
        }
        #grievances
        20 = {
            trigger = {
                event_target:court_witchhunter = {
                    num_of_rivals > 0
                    NOT = { has_character_flag = order_of_the_sword_and_scale_witch_hunter }
                }
            }
            modifier = {
                factor = 0.25
                event_target:court_witchhunter = {
                    trait = just
                }
            }
            modifier = {
                factor = 2
                event_target:court_witchhunter = {
                    trait = arbitrary
                }
            }
            modifier = {
                factor = 1.5
                event_target:court_witchhunter = {
                    OR = {
                        trait = cruel
                        trait = wroth
                    }
                }
            }
            event_target:court_witchhunter = {
                random_rival = {
                    accused_by_witch_hunter_effect = yes
                }
            }
        }
        #all clear
        20 = {
            modifier = {
                factor = 1.5
                event_target:court_witchhunter = {
                    trait = content
                }
            }
            modifier = {
                factor = 2
                event_target:court_witchhunter = {
                    trait = slothful
                }
            }
            modifier = {
                factor = 0.5
                event_target:court_witchhunter = {
                    trait = diligent
                }
            }
            #might request additional resources?
        }
    }
}

#accused character scope
#event_target:court_witchhunter must be identified going into this
accused_by_witch_hunter_effect = {
    save_event_target_as = courtier_accused_by_witch_hunter
    #determin accused's evidence
    set_variable = {
        which = witch_hunter_evidence
        value = 0
    }
    #even if the accused is innocent, having a strong intrigue score means that they probably avoided suspicious behavior
    export_to_variable = {
        which = witch_hunter_evidence
        value = intrigue
    }
    #the powerful are protected
    trigger_switch = {
        on_trigger = tier
        BARON = {
            change_variable = {
                which = witch_hunter_evidence
                value = 2
            }
        }
        COUNT = {
            change_variable = {
                which = witch_hunter_evidence
                value = 4
            }
        }
        DUKE = {
            change_variable = {
                which = witch_hunter_evidence
                value = 6
            }
        }
        KING = {
            change_variable = {
                which = witch_hunter_evidence
                value = 8
            }
        }
        KING = {
            change_variable = {
                which = witch_hunter_evidence
                value = 10
            }
        }
    }
    ## Mutation effects ##
    #massive mutation
    if = {
        limit = {
            check_variable = {
                which = mutation_counter
                value = 5
            }
        }
        subtract_variable = {
            which = witch_hunter_evidence
            value = 3
        }
    }
    #major mutation
    else_if = {
        limit = {
            check_variable = {
                which = mutation_counter
                value = 3
            }
        }
        subtract_variable = {
            which = witch_hunter_evidence
            value = 2
        }
    }
    #minor mutation
    else_if = {
        limit = {
            check_variable = {
                which = mutation_counter
                value = 1
            }
        }
        subtract_variable = {
            which = witch_hunter_evidence
            value = 1
        }
    }
    #determine strength of hunter's case & simulate their judgment
    #the intent is to simulate a "kangaroo court" where the accused is believed guilty going in and will struggle to clear their name
    event_target:court_witchhunter = {
        set_variable = {
            which = witch_hunter_evidence
            value = 0
        }
        export_to_variable = {
            which = witch_hunter_evidence
            value = intrigue
        }
        #trait modifiers
        if = {
            limit = {
                trait = diligent
            }
            change_variable = {
                which = witch_hunter_evidence
                value = 2
            }
        }
        if = {
            limit = {
                trait = slothful
            }
            subtract_variable = {
                which = witch_hunter_evidence
                value = 2
            }
        }
        #hunter flag advantages
        trigger_switch = {
            on_trigger = has_character_flag
            #champion of order
            emissary_of_order_witch_hunter = {
                if = {
                    limit = {
                        accused_courtier_is_secret_chaos_worshipper_trigger = yes
                    }
                    change_variable = {
                        which = witch_hunter_evidence
                        value = 5
                    }
                }
            }
            #specialist necromancy fighters
            order_of_the_shroud_witch_hunter = {
                if = {
                    limit = {
                        accused_courtier_is_secret_necromantic_acolyte_trigger = yes
                    }
                    change_variable = {
                        which = witch_hunter_evidence
                        value = 3
                    }
                }
            }
            #specialist chaos fighters
            temple_of_solkan_witch_hunter = {
                if = {
                    limit = {
                        accused_courtier_is_secret_chaos_worshipper_trigger = yes
                    }
                    change_variable = {
                        which = witch_hunter_evidence
                        value = 3
                    }
                }
            }
            #Order of the Sword and Scale are masterful investigators
            order_of_the_sword_and_scale_witch_hunter = {
                change_variable = {
                    which = witch_hunter_evidence
                    value = 8
                }
            }
        }
        #now modify by the accused's evidence score
        subtract_variable = {
            which = witch_hunter_evidence
            which = PREV
        }
        #determine witch hunter's verdict
        if = {
            limit = {
                check_variable = {
                    which = witch_hunter_evidence
                    value > 5
                }
            }
            #HUNTER DISCOVERS MUCH ABOUT THE CASE
            event_target:courtier_accused_by_witch_hunter = {
                #A successful investigation of a cultist damages the cult's influence
                persistent_event_target:underground_cult_allegiance = {
                    holder_scope = {
                        subtract_variable = {
                            which = cultic_influence
                            value = -15
                        }
                    }
                }
                #if they're really guilty, then it's burning time
                if = {
                    limit = {
                        OR = {
                            trait = underground_cult_member
                            is_mutated_trigger = yes
                            has_magic_potential = yes
                            is_foe = PREV
                        }
                    }
                    found_guilty_by_witch_hunter_effect = yes
                }
                #if they're not guilty but it still looks bad... it depends
                else = {
                    random_list = {
                        50 = {
                            trigger = {
                                #some hunters don't take chances when it comes to purging the guilty
                                NOR = {
                                    trait = paranoid
                                    trait = cruel
                                    trait = impaler
                                    has_character_flag = temple_of_solkan_witch_hunter
                                }
                            }
                            #benefit of the doubt
                            #go on your way, citizen
                        }
                        50 = {
                            trigger = {
                                #some hunters don't take chances when it comes to protecting the innocent
                                NOR = {
                                    trait = just
                                    has_character_flag = bretonnian_knight_witch_hunter
                                    has_character_flag = order_of_the_sword_and_scale_witch_hunter
                                }
                            }
                            found_guilty_by_witch_hunter_effect = yes
                        }
                    }
                }
            }
        }
        else_if = {
            limit = {
                check_variable = {
                    which = witch_hunter_evidence
                    value < -5
                }
            }
            #INNOCENT
            #go on your way, citizen
        }
        else = {
            #hunter is unsure and goes with their gut
            event_target:courtier_accused_by_witch_hunter = {
                random_list = {
                    50 = {
                        trigger = {
                            #some hunters don't take chances when it comes to purging the guilty
                            NOR = {
                                trait = paranoid
                                trait = cruel
                                trait = impaler
                                has_character_flag = temple_of_solkan_witch_hunter
                            }
                        }
                        #benefit of the doubt
                        #go on your way, citizen
                    }
                    #TODO: intermediate result: witch hunter passes on their uncertainty to their employer
                    50 = {
                        trigger = {
                            #some hunters don't take chances when it comes to protecting the innocent
                            NOR = {
                                trait = just
                                has_character_flag = bretonnian_knight_witch_hunter
                                has_character_flag = order_of_the_sword_and_scale_witch_hunter
                            }
                        }
                        #note that this result does not damage cult influence by itself, as the Hunter's investigation didn't reveal very much
                        found_guilty_by_witch_hunter_effect = yes
                    }
                }
            }
        }
    }
}

#accused character scope
found_guilty_by_witch_hunter_effect = {
    reverse_opinion = {
        modifier = opinion_witch
        who = event_target:court_witchhunter
        years = 100
    }
    #judgment by liege
    event_target:witch_hunter_employer = {
        #the arrow of law compels you!
        if = {
            limit = {
                event_target:court_witchhunter = {
                    has_character_flag = emissary_of_order_witch_hunter
                }
            }
            event_target:courtier_accused_by_witch_hunter = {
                at_the_mercy_of_the_emissary_effect = yes
            }
        }
        #untouchable
        else_if = {
            limit = {
                OR = {
                    character = event_target:courtier_accused_by_witch_hunter
                    any_lover = {
                        character = event_target:courtier_accused_by_witch_hunter
                    }
                }
            }
            opinion = {
                modifier = opinion_leave
                who = event_target:court_witchhunter
                years = 5
            }
        }
        #you had me at "your rival has been acting suspiciously"
        else_if = {
            limit = {
                any_rival = {
                    character = event_target:courtier_accused_by_witch_hunter
                }
            }
            event_target:courtier_accused_by_witch_hunter = {
                found_guilty_by_any_liege_effect = yes
            }
        }
        #considers the case
        else = {
            random_list = {
                80 = {
                    modifier = {
                        factor = 1.1
                        event_target:court_witchhunter = {
                            check_variable = {
                                which = witch_hunter_evidence
                                value > 5
                            }
                        }
                    }
                    modifier = {
                        factor = 1.1
                        event_target:court_witchhunter = {
                            check_variable = {
                                which = witch_hunter_evidence
                                value > 10
                            }
                        }
                    }
                    modifier = {
                        factor = 1.1
                        event_target:court_witchhunter = {
                            check_variable = {
                                which = witch_hunter_evidence
                                value > 15
                            }
                        }
                    }
                    event_target:courtier_accused_by_witch_hunter = {
                        found_guilty_by_any_liege_effect = yes
                    }
                }
                20 = {
                    trigger = {
                        NOR = {
                            trait = zealous
                            trait = cruel
                            trait = impaler
                        }
                    }
                    modifier = {
                        factor = 1.1
                        event_target:court_witchhunter = {
                            check_variable = {
                                which = witch_hunter_evidence
                                value < 0
                            }
                        }
                    }
                    reverse_opinion = {
                        modifier = opinion_disappointed
                        who = event_target:court_witchhunter
                        years = 5
                    }
                }
            }
        }
    }
}

#accused character scope
found_guilty_by_any_liege_effect = {
    imprison = event_target:witch_hunter_employer
    character_event = {
        id = wh_cults_and_hunters.701
        days = 2
    }
}
#accused character scope
at_the_mercy_of_the_emissary_effect = {
    if = {
        limit = {
            trait = underground_cult_member
        }
        #"tell me everything you know - everything!"
        persistent_event_target:underground_cult_allegiance = {
            holder_scope = {
                subtract_variable = {
                    which = cultic_influence
                    value = 250
                }
            }
        }
    }
    #this kills the accused courtier
    death = {
        death_reason = death_execution_burning
        killer = event_target:court_witchhunter
    }
}
