###########################################
#
# Holy Order Decisions for Sons of Abraham
#
###########################################
# Written by Henrik Fåhraeus
###########################################

# Holy Order Decisions are listed for each existing holy order of the right religion

decisions = {

	borrow_money_knights_blazing_sun = {
		potential = {
			religion = classical_pantheon
			is_heretic = no
			is_title_active = d_knights_of_the_blazing_sun
			NOT = { trait = witch_hunter }
			NOT = { has_character_modifier = borrowed_from_knights_blazing_sun }
			NOT = { has_character_modifier = expelled_d_knights_of_the_blazing_sun }
			NOT = { is_nomadic = yes }

			has_dlc = "Sons of Abraham"

			d_knights_of_the_blazing_sun = {
				holder_scope = {
					liege = {
						NOT = { character = ROOT }
					}
				}
			}
		}

		allow = {
			d_knights_of_the_blazing_sun = {
				holder_scope = {
					wealth = 300
					ROOT = {
						NOT = { excommunicated_for = PREV }
					}
				}
			}
		}

		effect = {
			add_character_modifier = {
				name = borrowed_from_knights_blazing_sun
				duration = -1
				inherit = yes
			}

			hidden_tooltip = {
				d_knights_of_the_blazing_sun = {
					holder_scope = {
						character_event = {
							id = SoA_HolyOrders.1210
						}
					}
				}
			}

			wealth = 300
		}

		revoke_allowed = {
			always = no
		}

		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0
				wealth = 0
			}
			modifier = {
				factor = 0.01 # Slow it down
			}
		}
	}

	expel_the_knights_blazing_sun = {
		potential = {
			ai = no
			religion = classical_pantheon
			is_heretic = no
			higher_tier_than = DUKE
			independent = yes
			is_title_active = d_knights_of_the_blazing_sun
			NOT = { trait = witch_hunter }
			NOT = { has_character_modifier = expelled_d_knights_of_the_blazing_sun }

			any_realm_province = {
				any_province_lord = {
					d_knights_of_the_blazing_sun = {
						holder_scope = {
							OR = {
								character = PREVPREV
								is_vassal_or_below = PREVPREV
							}
						}
					}
				}
			}

			has_dlc = "Sons of Abraham"
		}

		allow = {
			piety = 1000
		}

		effect = {
			piety = -1000

			religion_authority = {
				modifier = holy_order_expelled
				years = 20
			}

			hidden_tooltip = {
				d_knights_of_the_blazing_sun = {
					holder_scope = {
						character_event = {
							id = SoA_HolyOrders.1260
						}
					}
				}
				add_character_modifier = {
					name = expelled_d_knights_of_the_blazing_sun
					duration = -1
					inherit = yes
				}
			}
		}

		revoke_allowed = {
			always = no
		}

		ai_will_do = {
			factor = 0
		}
	}

	donate_money_to_knights_blazing_sun = {
		potential = {
			religion = classical_pantheon
			is_heretic = no
			is_title_active = d_knights_of_the_blazing_sun
			NOT = { trait = witch_hunter }

			NOT = { has_character_modifier = expelled_d_knights_of_the_blazing_sun }


			has_dlc = "Sons of Abraham"

			d_knights_of_the_blazing_sun = {
				holder_scope = {
					liege = {
						NOT = { character = ROOT }
					}
				}
			}
		}

		allow = {
			wealth = 300
		}

		effect = {
			if = {
				limit = {
					NOT = { has_character_modifier = donated_to_holy_order }
				}
				add_character_modifier = {
					name = donated_to_holy_order
					duration = -1
				}
			}

			hidden_tooltip = {
				d_knights_of_the_blazing_sun = {
					holder_scope = {
						character_event = {
							id = SoA_HolyOrders.1140
						}
					}
				}
			}

			wealth = -300
			piety = 300
		}

		revoke_allowed = {
			always = no
		}

		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0
				OR = {
					piety = 1000
					NOT = { wealth = 1000 }
					AND = {
						NOT = { controls_religion = classical_pantheon }
					}
				}
			}
			modifier = {
				factor = 0.002 # Slow it down
			}
		}
	}

	borrow_money_order_eagle = {
		potential = {
			religion = classical_pantheon
			is_heretic = no
			is_title_active = d_order_of_the_eagle
			NOT = { trait = witch_hunter }
			NOT = { has_character_modifier = borrowed_from_order_eagle }
			NOT = { has_character_modifier = expelled_d_order_of_the_eagle }
			NOT = { is_nomadic = yes }

			has_dlc = "Sons of Abraham"

			d_order_of_the_eagle = {
				holder_scope = {
					liege = {
						NOT = { character = ROOT }
					}
				}
			}
		}

		allow = {
			d_order_of_the_eagle = {
				holder_scope = {
					wealth = 300
					ROOT = {
						NOT = { excommunicated_for = PREV }
					}
				}
			}
		}

		effect = {
			add_character_modifier = {
				name = borrowed_from_order_eagle
				duration = -1
				inherit = yes
			}

			hidden_tooltip = {
				d_order_of_the_eagle = {
					holder_scope = {
						character_event = {
							id = SoA_HolyOrders.1610
						}
					}
				}
			}

			wealth = 300
		}

		revoke_allowed = {
			always = no
		}

		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0
				wealth = 0
			}
			modifier = {
				factor = 0.01 # Slow it down
			}
		}
	}

	expel_the_order_eagle = {
		potential = {
			ai = no
			religion = classical_pantheon
			is_heretic = no
			higher_tier_than = DUKE
			independent = yes
			is_title_active = d_order_of_the_eagle
			NOT = { trait = witch_hunter }
			NOT = { has_character_modifier = expelled_d_order_of_the_eagle }

			any_realm_province = {
				any_province_lord = {
					d_order_of_the_eagle = {
						holder_scope = {
							OR = {
								character = PREVPREV
								is_vassal_or_below = PREVPREV
							}
						}
					}
				}
			}

			has_dlc = "Sons of Abraham"
		}

		allow = {
			piety = 1000
		}

		effect = {
			piety = -1000

			religion_authority = {
				modifier = holy_order_expelled
				years = 20
			}

			hidden_tooltip = {
				d_order_of_the_eagle = {
					holder_scope = {
						character_event = {
							id = SoA_HolyOrders.1660
						}
					}
				}
				add_character_modifier = {
					name = expelled_d_order_of_the_eagle
					duration = -1
					inherit = yes
				}
			}
		}

		revoke_allowed = {
			always = no
		}

		ai_will_do = {
			factor = 0
		}
	}

	donate_money_to_order_eagle = {
		potential = {
			religion = classical_pantheon
			is_heretic = no
			is_title_active = d_order_of_the_eagle
			NOT = { trait = witch_hunter }

			NOT = { has_character_modifier = expelled_d_order_of_the_eagle }


			has_dlc = "Sons of Abraham"

			d_order_of_the_eagle = {
				holder_scope = {
					liege = {
						NOT = { character = ROOT }
					}
				}
			}
		}

		allow = {
			wealth = 300
		}

		effect = {
			if = {
				limit = {
					NOT = { has_character_modifier = donated_to_holy_order }
				}
				add_character_modifier = {
					name = donated_to_holy_order
					duration = -1
				}
			}

			hidden_tooltip = {
				d_order_of_the_eagle = {
					holder_scope = {
						character_event = {
							id = SoA_HolyOrders.1140
						}
					}
				}
			}

			wealth = -300
			piety = 300
		}

		revoke_allowed = {
			always = no
		}

		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0
				OR = {
					piety = 1000
					NOT = { wealth = 1000 }
					AND = {
						NOT = { controls_religion = classical_pantheon }
					}
				}
			}
			modifier = {
				factor = 0.002 # Slow it down
			}
		}
	}

	expel_the_assassins = {
		potential = {
			ai = no
			OR = {
				religion = ormazd
				religion = kitabid
			}
			is_heretic = no
			higher_tier_than = DUKE
			independent = yes
			is_title_active = d_hashishin
			NOT = { has_character_modifier = expelled_d_hashishin }

			any_realm_province = {
				any_province_lord = {
					d_hashishin = {
						holder_scope = {
							OR = {
								character = PREVPREV
								is_vassal_or_below = PREVPREV
							}
						}
					}
				}
			}

			has_dlc = "Sons of Abraham"
		}

		allow = {
			piety = 1000
		}

		effect = {
			piety = -1000

			religion_authority = {
				modifier = holy_order_expelled
				years = 20
			}

			hidden_tooltip = {
				d_hashishin = {
					holder_scope = {
						character_event = {
							id = SoA.1460
						}
					}
				}

				add_character_modifier = {
					name = expelled_d_hashishin
					duration = -1
					inherit = yes
				}
			}
		}

		revoke_allowed = {
			always = no
		}

		ai_will_do = {
			factor = 0
		}
	}

	borrow_money_assassins = {
		potential = {
			OR = {
				religion = ormazd
				religion = kitabid
			}
			is_heretic = no
			is_title_active = d_hashishin
			NOR = { has_character_modifier = borrowed_from_hashishin
					has_character_modifier = expelled_d_hashishin
					is_nomadic = yes
					society_member_of = the_assassins
					}

			has_dlc = "Sons of Abraham"

			d_hashishin = {
				holder_scope = {
					liege = {
						NOT = { character = ROOT }
					}
				}
			}
		}

		allow = {
			d_hashishin = {
				holder_scope = {
					wealth = 300
				}
			}
		}

		effect = {
			add_character_modifier = {
				name = borrowed_from_hashishin
				duration = -1
				inherit = yes
			}

			hidden_tooltip = {
				d_hashishin = {
					holder_scope = {
						character_event = {
							id = SoA.1410
						}
					}
				}
			}

			wealth = 300
		}

		revoke_allowed = {
			always = no
		}

		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0
				wealth = 0
			}
			modifier = {
				factor = 0.01 # Slow it down
			}
		}
	}

	donate_money_to_assassins = {
		potential = {
			OR = {
				religion = ormazd
				religion = kitabid
			}
			is_heretic = no
			is_title_active = d_hashishin

			NOR = { has_character_modifier = expelled_d_hashishin
					society_member_of = the_assassins
					}

			has_dlc = "Sons of Abraham"

			d_hashishin = {
				holder_scope = {
					liege = {
						NOT = { character = ROOT }
					}
				}
			}
		}

		allow = {
			wealth = 300
		}

		effect = {

			hidden_tooltip = {
				d_hashishin = {
					holder_scope = {
						character_event = {
							id = SoA.1140
						}
					}
				}
			}

			wealth = -300
			piety = 300
		}

		revoke_allowed = {
			always = no
		}

		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0
				OR = {
					piety = 1000
					NOT = { wealth = 1000 }
				}
			}
			modifier = {
				factor = 0.002 # Slow it down
			}
		}
	}

}
