
targetted_decisions = {
	swap_character_breakaway = {
		filter = all
		only_rulers = yes
		is_high_prio = yes
		ai=no
		from_potential = {
			has_character_flag=breakaway_swapping
		}
		potential = {
			from={
			has_opinion_modifier = {
				who = ROOT
				name = opinion_breakaway_nomad
			}}
		}
		allow = {}
		effect = {from={set_player_character=ROOT}}
	}
}
settlement_decisions = {
	refurbish_special_building = {
		only_playable = yes
		is_high_prio = yes
		filter = owned
		ai_target_filter = owned
		ai_check_interval = 360

		from_potential = {
			is_ruler = yes
			NOT={trait=creature_beastman}
			OR={
				from={culture_group=asrai_group}
				from={culture_group=goblin_group}
			}
			not={culture=goblin_forest}
			OR={
				ai=no
				root={location={has_wonder = no}} #To prevent AI from disabling wonder's special units
			}
		}
		potential={
			ROOT={owner={character=FROM}}
		}
		allow = {
			conditional_tooltip = {
				trigger = {from={culture_group=asrai_group}}
				FROM={prestige=250}
				ROOT={
					holding_type=tribal
					OR={
						has_building=tb_magicarcher_lodge_1
						has_building=tb_magicarcher_lodge_2
						has_building=tb_magicarcher_lodge_3
						has_building=tb_magicarcher_lodge_4
						has_building=tb_magicarcher_lodge_5
						has_building=tb_treekin_moot_1
						has_building=tb_treekin_moot_2
						has_building=tb_treekin_moot_3
						has_building=tb_treekin_moot_4
						has_building=tb_treekin_moot_5
					}
				}
			}
			conditional_tooltip = {
				trigger = {from={
					culture_group=goblin_group
					not={culture=goblin_forest}
					}
				}
				FROM={prestige=250}
				ROOT={
					holding_type=tribal
					OR={
						has_building=tb_goblin_wolf_pit_1
						has_building=tb_goblin_wolf_pit_2
						has_building=tb_goblin_wolf_pit_3
						has_building=tb_goblin_wolf_pit_4
						has_building=tb_troll_pen_1
						has_building=tb_troll_pen_2
						has_building=tb_troll_pen_3
						has_building=tb_troll_pen_4
						has_building=tb_goblin_wolf_pit_hill_1
						has_building=tb_goblin_wolf_pit_hill_2
						has_building=tb_goblin_wolf_pit_hill_3
						has_building=tb_goblin_wolf_pit_hill_4
						has_building=tb_troll_pen_hill_1
						has_building=tb_troll_pen_hill_2
						has_building=tb_troll_pen_hill_3
						has_building=tb_troll_pen_hill_4
					}
				}
			}
		}

		effect = {
			if={limit={from={culture_group=asrai_group}}
				FROM={prestige=-250}
				trigger_switch = {
					on_trigger = has_building
					tb_magicarcher_lodge_1={remove_building=tb_magicarcher_lodge_1 add_building=tb_treekin_moot_1}
					tb_magicarcher_lodge_2={remove_building=tb_magicarcher_lodge_2 add_building=tb_treekin_moot_1}
					tb_magicarcher_lodge_3={remove_building=tb_magicarcher_lodge_3 add_building=tb_treekin_moot_2}
					tb_magicarcher_lodge_4={remove_building=tb_magicarcher_lodge_4 add_building=tb_treekin_moot_3}
					tb_magicarcher_lodge_5={remove_building=tb_magicarcher_lodge_5 add_building=tb_treekin_moot_4}
					tb_treekin_moot_1={remove_building=tb_treekin_moot_1 add_building=tb_magicarcher_lodge_1}
					tb_treekin_moot_2={remove_building=tb_treekin_moot_2 add_building=tb_magicarcher_lodge_1}
					tb_treekin_moot_3={remove_building=tb_treekin_moot_3 add_building=tb_magicarcher_lodge_2}
					tb_treekin_moot_4={remove_building=tb_treekin_moot_4 add_building=tb_magicarcher_lodge_3}
					tb_treekin_moot_5={remove_building=tb_treekin_moot_5 add_building=tb_magicarcher_lodge_4}
				}
			}
			if={limit={from={culture_group=goblin_group}}
				FROM={prestige=-250}
				trigger_switch = {
					on_trigger = has_building
					tb_troll_pen_1={remove_building=tb_troll_pen_1 remove_building=tb_river_troll_caves add_building=tb_goblin_wolf_pit_1}
					tb_troll_pen_2={remove_building=tb_troll_pen_2 remove_building=tb_river_troll_caves add_building=tb_goblin_wolf_pit_1}
					tb_troll_pen_3={remove_building=tb_troll_pen_3 remove_building=tb_river_troll_caves add_building=tb_goblin_wolf_pit_2}
					tb_troll_pen_4={remove_building=tb_troll_pen_4 remove_building=tb_river_troll_caves add_building=tb_goblin_wolf_pit_3}
					tb_goblin_wolf_pit_1={remove_building=tb_goblin_wolf_pit_1 add_building=tb_troll_pen_1}
					tb_goblin_wolf_pit_2={remove_building=tb_goblin_wolf_pit_2 add_building=tb_troll_pen_1}
					tb_goblin_wolf_pit_3={remove_building=tb_goblin_wolf_pit_3 add_building=tb_troll_pen_1}
					tb_goblin_wolf_pit_4={remove_building=tb_goblin_wolf_pit_4 add_building=tb_troll_pen_1}
					tb_goblin_wolf_pit_hill_1={remove_building=tb_goblin_wolf_pit_hill_1 add_building=tb_troll_pen_1}
					tb_goblin_wolf_pit_hill_2={remove_building=tb_goblin_wolf_pit_hill_2 add_building=tb_troll_pen_2}
					tb_goblin_wolf_pit_hill_3={remove_building=tb_goblin_wolf_pit_hill_3 add_building=tb_troll_pen_3}
					tb_goblin_wolf_pit_hill_4={remove_building=tb_goblin_wolf_pit_hill_4 add_building=tb_troll_pen_4}
					tb_troll_pen_hill_1={remove_building=tb_troll_pen_hill_1 remove_building=tb_river_troll_caves add_building=tb_goblin_wolf_pit_1}
					tb_troll_pen_hill_2={remove_building=tb_troll_pen_hill_2 remove_building=tb_river_troll_caves add_building=tb_goblin_wolf_pit_1}
					tb_troll_pen_hill_3={remove_building=tb_troll_pen_hill_3 remove_building=tb_river_troll_caves add_building=tb_goblin_wolf_pit_2}
					tb_troll_pen_hill_4={remove_building=tb_troll_pen_hill_4 remove_building=tb_river_troll_caves add_building=tb_goblin_wolf_pit_3}
				}
			}
		}
	}
	waaagh_make_county_capital = {
		only_playable = yes
		is_high_prio = yes
		filter = owned
		ai_target_filter = owned
		ai_check_interval = 36

		from_potential = {
			is_ruler = yes
			is_nomadic=yes
			NOT={trait=creature_beastman}
			#OR = {
			#	has_game_rule = { name = dynamic_crusader_states value = default }
			#	AND = {
			#		ai = no
			#		has_game_rule = { name = dynamic_crusader_states value = limited }
			#	}
			#}
		}

		potential = {
			ROOT={
				is_capital=no
			}
		}

		allow = {
			ROOT={
				NOT={ has_holding_modifier = recently_made_capital }
				is_capital=no
				location={
					NOR={ 
						any_province_holding = {
							has_holding_modifier = recently_made_capital
						} 
						any_province_holding = {
							holding_type=nomad
						}
					}
				}
			}
		}

		effect = {
			ROOT = {
				make_capital_holding = yes
				add_holding_modifier = {
					modifier = recently_made_capital
					years = 1
				}
			}
		}
	}
}
title_decisions = {
	dynamic_waaagh_outliers = {
		only_playable = yes
		is_high_prio = yes
		filter = all
		ai_target_filter = all
		ai_check_interval = 36

		from_potential = {
			is_ruler = yes
			religion_group = greenskin_gods_group
			any_war = {
				using_cb = waaagh_war
			}
			#OR = {
			#	has_game_rule = { name = dynamic_crusader_states value = default }
			#	AND = {
			#		ai = no
			#		has_game_rule = { name = dynamic_crusader_states value = limited }
			#	}
			#}
		}

		potential = {
			tier = COUNT
			is_alternate_start = no
			location = {
				num_of_settlements <= 4
				OR={
					controller={top_liege={character=FROM}}
					controller = { character = FROM }
				}
				NOR={ 
					owner={character=FROM}
					owner={top_liege={character=FROM}}
				}
			}
		}

		allow = {
			#ounty={
				#show_scope_change=no
				location = {
					num_of_settlements <= 4
					OR={
						controller={top_liege={character=FROM}}
						controller = { character = FROM }
					}
					owner={
						NOT={
							AND={
								OR={
									higher_tier_than=duke
									ai=no
								}
								capital_scope = { province = PREVPREV }
							}
						}
					}
				}
			#}
			FROM = {
				show_scope_change = no
				conditional_tooltip = {
					trigger = {
						any_owned_bloodline = {
							has_bloodline_flag = waaagh_warlord_bloodline_flag
							bloodline_is_active_for = PREV
						}
					}
					prestige = 300
					wealth = 100
				}
				conditional_tooltip = {
					trigger = {
						NOT={
							any_owned_bloodline = {
								has_bloodline_flag = waaagh_warlord_bloodline_flag
								bloodline_is_active_for = PREV
							}
						}
					}
					prestige = 500
					wealth = 300
				}
				conditional_tooltip = {
					trigger = {
						has_character_modifier = settled_warlord
						NOT={piety=2500}
					}
					OR={
						NOT = {
							has_character_modifier = settled_warlord
						}
						piety=2500
					}
				}
				conditional_tooltip = {
					trigger = {
						has_character_modifier = settled_warlord
						piety=2500
						NOT={piety=5000}
					}
					OR={
						has_instances_of_character_modifier = {
							name = settled_warlord
							amount < 2
						}
						piety=5000
					}
				}
				conditional_tooltip = {
					trigger = {
						has_character_modifier = settled_warlord
						piety=5000
					}
					has_instances_of_character_modifier = {
						name = settled_warlord
						amount < 3
					}
				}
			}
			custom_tooltip = {
				text = "dynamic_outlier_state_tooltip"
				NOT = {
					any_direct_de_jure_vassal_title = {
						NOT = {
							controlled_by = FROM
						}
					}
				}
			}
			custom_tooltip = {
				text = "dynamic_waaagh_outlier_tooltip_4"
				FROM = {
					OR = {
						any_courtier_or_vassal = {
							has_minor_title = title_greenskin_lieutenant
						}
						any_dynasty_member = {
							is_lowborn = no
							NOT = {
								any_heir_title = { 
									always = yes
								}
							}
							mercenary = no
							is_landed = no
							NOR = {
								trait = incapable
								is_female = yes
							}
							NAND = {
								player_heir = {
									OR = {
										is_landed = yes
										any_heir_title = { 
											always = yes
										}
									}
								}
							}
							NAND = {
								is_female = yes
								any_child = {
									is_landed = yes
								}
							}
						}
					}
				}
			}
		}

		effect = {
			FROM = {
				show_scope_change = no
				if = {
					limit = {						
						any_owned_bloodline = {
							has_bloodline_flag = waaagh_warlord_bloodline_flag
							bloodline_is_active_for = PREV
						}

					}
					prestige = -300
					wealth = -100
					if={
						limit={
							has_instances_of_character_modifier = {
								name = settled_warlord
								amount == 1
							}
						}
						piety=-250
					}
					else_if={
						limit={
							has_instances_of_character_modifier = {
								name = settled_warlord
								amount == 2
							}
						}
						piety=-500
					}
				}
				else = {
					prestige = -500
					wealth = -300
					if={
						limit={
							has_instances_of_character_modifier = {
								name = settled_warlord
								amount == 1
							}
						}
						piety=-500
					}
					else_if={
						limit={
							has_instances_of_character_modifier = {
								name = settled_warlord
								amount == 2
							}
						}
						piety=-1000
					}
				}
			}
			ROOT = {
				save_event_target_as = overlordship_region
			}
			FROM = {
				save_event_target_as = greenskin_overlord
				character_event = { id = WAAGH.50 }
			}
		}
	}
}