namespace = DR_chaos_dwarf
###Chaos Dwarfs
##Sacrifice to Hashut
#Chaos Dwarfs can be granted boons by Hashut depending on the number of sacrifices they've made
#They have access to 2 decisions, one targeted that allows them to get "favour points" by sacrificing prisoners
#And other that allows them to spend said points by asking Hashut for boons.

#Triggered by the "Sacrifice X to Hashut" decision
long_character_event = {
	id = DR_chaos_dwarf.1
	desc = EVTDESC_hashut_sac
	picture = GFX_evt_altar_hashut

	is_triggered_only = yes


	option = {
		name = EVTOPT_hashut_sac_dwarf
		trigger = {
			FROM = { trait = creature_dwarf }
		}
		piety = 150 #Normal Dwarfs are the most priced sacrifice
		change_variable = { which = "hashut_favor" value = 1 }
		# custom_tooltip = { text = hashut_sacrifice }
		if = {
			limit = {
				has_character_modifier = must_sacrifice_hashut
			}
			remove_character_modifier = must_sacrifice_hashut
		}
		clr_character_flag = flag_sacrifice_made_hashut
		set_character_flag = flag_sacrifice_made_hashut
		clr_character_flag = sacrificing_prisoner_hashut
		hidden_tooltip = {
			FROM = { character_event = { id = DR_chaos_dwarf.2 } }
		}
		ai_chance = { factor = 1000 }
	}

	option = {
		name = EVTOPT_hashut_sac_minor
		trigger = {
			FROM = { is_ruler = yes }
			FROM = { NOT = { trait = creature_dwarf } }
		}
		set_character_flag = sac_minor
		change_variable = { which = "hashut_favor" value = 1 }
		if = {
			limit = {
				has_character_modifier = must_sacrifice_hashut
			}
			remove_character_modifier = must_sacrifice_hashut
		}
		clr_character_flag = flag_sacrifice_made_hashut
		set_character_flag = flag_sacrifice_made_hashut
		clr_character_flag = sacrificing_prisoner_hashut
		piety = 100
		hidden_tooltip = {
			FROM = { character_event = { id = DR_chaos_dwarf.2 } }
		}
		ai_chance = { factor = 50 }
	}

	option = {
		name = EVTOPT_hashut_sac_courtier
		trigger = {
			FROM = { is_ruler = no }
			FROM = { NOT = { trait = creature_dwarf } }
		}
		piety = 50
		change_variable = { which = "hashut_favor" value = 1 }
		if = {
			limit = {
				has_character_modifier = must_sacrifice_hashut
			}
			remove_character_modifier = must_sacrifice_hashut
		}
		clr_character_flag = flag_sacrifice_made_hashut
		set_character_flag = flag_sacrifice_made_hashut
		clr_character_flag = sacrificing_prisoner_hashut
		hidden_tooltip = {
			FROM = { character_event = { id = DR_chaos_dwarf.2 } }
		}
		ai_chance = { factor = 10 }
	}
}

#Tell the sacrifice that well... it's dead.
character_event = {
	id = DR_chaos_dwarf.2
	desc = EVTDESC_hashut_sacrifice_killed
	picture = GFX_evt_altar_hashut

	is_triggered_only = yes

	option = {
		name = OK
		if = {
 limit = {
 is_invincible_trigger = yes
 }

			antideath_effect = yes
			break = yes
}
		death = { death_reason = death_sacrificed killer = FROM }
		any_dynasty_member = {
			opinion = {
				modifier = opinion_sacrificed_family
				who = FROM
			}
		}
		if = {
			limit = { is_close_relative = FROM }
			FROM = { add_trait = kinslayer }
		}
	}
}

##Sorcerer's Curse ( Chaos Dwarf Petrification ) events reworked

#sell into slavery events removed

#Great Taurus mount event
character_event = {
	id = DR_chaos_dwarf.20
	desc = EVTDESC_chaos_dwarf_great_taurus

	# desc = {
		# trigger = { NOT = { capital_scope = { kingdom = { title = k_zharrduk } } } }
		# text = = EVTDESCB_chaos_dwarf_great_taurus
	# }

	picture = "GFX_evt_desert"

	is_triggered_only = yes

	option = {
		name = EVTOPTA_chaos_dwarf_great_taurus
		set_character_flag = taming_beast
		piety = -1000
		character_event = { id = DR_chaos_dwarf.21 days = 1825 }
	}

	option = {
		name = ILL_WAIT_A_BIT
		trigger = { ai = no }
	}

}

character_event = {
	id = DR_chaos_dwarf.21

	desc = EVTDESC_chaos_dwarf_great_taurus_trained
	picture = "GFX_evt_great_taurus"

	is_triggered_only = yes

	option = {
		name = EVTOPTA_chaos_dwarf_great_taurus_trained
		add_artifact = great_taurus_mount
	}

}

#Lamassu mount event
character_event = {
	id = DR_chaos_dwarf.22

	desc = EVTDESC_chaos_dwarf_lamassu

	picture = "GFX_evt_desert"

	is_triggered_only = yes

	option = {
		name = EVTOPTA_chaos_dwarf_lamassu
		set_character_flag = taming_beast
		piety = -1000
		character_event = { id = DR_chaos_dwarf.23 days = 1825 }
	}

	option = {
		name = ILL_WAIT_A_BIT
		trigger = { ai = no }
	}

}

character_event = {
	id = DR_chaos_dwarf.23

	desc = EVTDESC_chaos_dwarf_lamassu_trained
	picture = "GFX_evt_lamassu"

	is_triggered_only = yes

	option = {
		name = EVTOPTA_chaos_dwarf_lamassu_trained
		add_artifact = lamassu_mount
	}

}

#Old Grand Sacrifice removed

#Old sorcerer-prophet apotheosis event removed
